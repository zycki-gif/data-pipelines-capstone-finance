{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Dummy-Data-Generator-Test\nThe purpose of this notebook is to faciliate testing of the dummy data generator.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "00f9deb8-d7f9-4a9a-bbbe-9a734406b1bc", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a614bb29-8b9e-45de-abc1-7de4916fa6d3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "016c169f-d8a5-4f53-b120-92ab270ec740", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0c89ed58-f197-4f98-8bc8-a6842baa7774", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b94402aa-4d8d-4b4c-9c6b-ce394cbd1a24", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "33f64220-839b-41e3-977d-629d4ebd2e69", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "24227666-4859-48fb-ae45-fa355de833ac", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "bc380ce0-6c3a-41e0-8e79-4e794d52b70c", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "courseType = \"test\"\nmoduleName = getModuleName()\nlessonName = getLessonName()\nusername = getUsername()\nuserhome = getUserhome()\nworkingDir = getWorkingDir(courseType)\ndatabaseName = createUserDatabase(courseType, username, moduleName, lessonName)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "8181316d-986a-42ed-ae1d-f700487631f1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "949f1d12-25a9-46e1-a079-dcaec9455e6a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e3393401-489d-4110-87e1-a824ddec1eab", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "dffcc4b7-94cf-409f-8e9e-33761c55ea9a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "# name: String = \"Name\", \n# id: String = \"ID\", \n# password: String = \"Password\", \n# amount: String = \"Amount\", \n# percent: String = \"Percent\", \n# probability: String = \"Probability\", \n# yesNo: String = \"YesNo\", \n# UTCTime: String = \"UTCTime\"\nfrom pyspark.sql import Row\nfrom pyspark.sql.types import *\nimport os\n\n# default rows\ntestDefaultRowsDF = DummyData(\"test_1_python\").toDF()\nassert testDefaultRowsDF.count() == 300\n\n# custom rows\ntestCustomRowsDF = DummyData(\"test_2_python\", numRows=50).toDF()\nassert testCustomRowsDF.count() == 50\n\n# custom field names\ntestCustomField1DF = DummyData(\"test_3_python\").addNames(\"EmployeeName\").toDF()\nfields1 = testCustomField1DF.schema.names \nassert \"EmployeeName\" in fields1\nassert testCustomField1DF.schema.fields[1].dataType == StringType()\n\ntestCustomField2DF = DummyData(\"test_4_python\").renameId(\"EmployeeID\").toDF()\nfields2 = testCustomField2DF.schema.names \nassert \"EmployeeID\" in fields2\nassert testCustomField2DF.schema.fields[0].dataType == LongType()\n\ntestCustomField3DF = DummyData(\"test_5_python\").addPasswords(\"Yak\").toDF()\nfields3 = testCustomField3DF.schema.names\nassert testCustomField3DF.schema.fields[1].dataType == StringType()\nassert \"Yak\" in fields3\n\ntestCustomField4DF = DummyData(\"test_6_python\").addDoubles(\"Salary\").toDF()\nfields4 = testCustomField4DF.schema.names \nassert testCustomField4DF.schema.fields[1].dataType == DoubleType()\nassert \"Salary\" in fields4\n\ntestCustomField5DF = DummyData(\"test_7_python\").addIntegers(\"ZeroTo100\").toDF()\nfields5 = testCustomField5DF.schema.names \nassert testCustomField5DF.schema.fields[1].dataType == IntegerType()\nassert \"ZeroTo100\" in fields5\n\ntestCustomField6DF = DummyData(\"test_8_python\").addProportions(\"Prob\").toDF()\nfields6 = testCustomField6DF.schema.names \nassert testCustomField6DF.schema.fields[1].dataType == DoubleType()\nassert \"Prob\" in fields6 \n\ntestCustomField7DF = DummyData(\"test_9_python\").addBooleans(\"isOK\").toDF()\nfields7 = testCustomField7DF.schema.names \nassert testCustomField7DF.schema.fields[1].dataType == BooleanType()\nassert \"isOK\" in fields7\n\ntestCustomField8DF = DummyData(\"test_10_python\").addTimestamps(\"Timestamp\").toDF()\nfields8 = testCustomField8DF.schema.names \nassert testCustomField8DF.schema.fields[1].dataType == IntegerType()\nassert \"Timestamp\" in fields8\n\n# all custome field names, custom rows\ntestCustomFieldsDF = (DummyData(\"test_11_python\", numRows=50)\n    .addNames(\"EmployeeName\")\n    .renameId(\"EmployeeID\")\n    .addPasswords(\"Yak\")\n    .addDoubles(\"Salary\")\n    .addIntegers(\"ZeroTo100\")\n    .addProportions(\"Prob\")\n    .addBooleans(\"isOK\")\n    .addTimestamps(\"Timestamp\")\n    .toDF())\nfields = testCustomFieldsDF.schema.names\nassert fields == ['EmployeeID', 'EmployeeName', 'Yak', 'Salary', 'ZeroTo100', 'Prob', 'isOK', 'Timestamp']\nassert testCustomFieldsDF.count() == 50\nassert testCustomFieldsDF.schema.fields[0].dataType == LongType()\nassert testCustomFieldsDF.schema.fields[1].dataType == StringType()\nassert testCustomFieldsDF.schema.fields[2].dataType == StringType()\nassert testCustomFieldsDF.schema.fields[3].dataType == DoubleType()\nassert testCustomFieldsDF.schema.fields[4].dataType == IntegerType()\nassert testCustomFieldsDF.schema.fields[5].dataType == DoubleType()\nassert testCustomFieldsDF.schema.fields[6].dataType == BooleanType()\nassert testCustomFieldsDF.schema.fields[7].dataType == IntegerType()\n\n# needs to be done: restructure testing format to match class-utility-methods\n# needs to be done: add unit testing for the DummyData.add*() methods and their parameters\n# needs to be done: add value testing", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c3965e0e-a921-4282-8829-8140e4eb8890", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7bafa040-e7cf-48e3-9f54-1364400b6de9", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.sql(f\"DROP DATABASE IF EXISTS {databaseName} CASCADE\")\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d31871f3-5385-48d3-b13d-071127b0e0ac", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2d8a2392-eb07-40a8-b268-4a8c3125ad8d", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "704ad512-86b1-40f8-87ca-f9e756480ee5", "iPythonMetadata": null, "inputWidgets": {}, "language": "python", "name": "Dummy-Data-Generator-Test", "origId": 0, "version": "NotebookV1"}