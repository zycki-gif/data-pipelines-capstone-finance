{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%python\n# We need the python version of financeDataPath in 03B - it has an ALL_NOTEBOOKS Python code which needs to be execute\n# There shouldn't be anything else in this cell that would vary between Python and Scala doing this to the whole cell should be OK\n\nfinanceDataPath = \"dbfs:/mnt/training/finance-org\"\n\nspark.conf.set(\"com.databricks.training.module-name\", \"capstone-finance\")\n\nspark.conf.set(\"com.databricks.training.suppress.untilStreamIsReady\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.stopAllStreams\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.moduleName\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.lessonName\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.username\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.userhome\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.workingDir\", \"true\")\n\ndisplayHTML(\"Preparing the learning environment...\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "62fa3ede-8330-4111-b5e0-f005361cbe8f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "30dc9d1d-9ef4-482f-97c6-edc19ebc3b83", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val financeDataPath = \"dbfs:/mnt/training/finance-org\"\n\nspark.conf.set(\"com.databricks.training.module-name\", \"capstone-finance\")\n\nspark.conf.set(\"com.databricks.training.suppress.untilStreamIsReady\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.stopAllStreams\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.moduleName\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.lessonName\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.username\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.userhome\", \"true\")\nspark.conf.set(\"com.databricks.training.suppress.workingDir\", \"true\")\n\ndisplayHTML(\"Preparing the learning environment...\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6d18503b-4282-4b55-9914-8b61845712cf", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "d1c08353-8e06-4f26-b168-d416d9cf95ab", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Common-Notebooks/Common", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "eb2f91e1-dda1-4655-a930-2f693b86ed52", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0f28bbe2-0ad1-4da8-85b7-7c1ce242d412", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "courseAdvertisements += (\"financeDataPath\" -> (\"v\", financeDataPath, \"The location of the finance dataset used in this capstone project.\"))\n\nval sourceDataPath = financeDataPath + \"/solutions\"\ncourseAdvertisements += (\"sourceDataPath\" -> (\"v\", sourceDataPath, \"The location of the specific datasets used in this capstone project as source data.\"))\n\ndef roundDataFrame(df:org.apache.spark.sql.DataFrame): org.apache.spark.sql.DataFrame = {\n  df.schema.filter(c =>\n    c.dataType == org.apache.spark.sql.types.DoubleType || c.dataType == org.apache.spark.sql.types.FloatType)\n  .foldRight(df){ (c, currDF) => currDF.withColumn(c.name, org.apache.spark.sql.functions.floor(org.apache.spark.sql.functions.col(c.name)))}\n}\n\ndef compareDataFramesLimited(df1:org.apache.spark.sql.DataFrame, df2:org.apache.spark.sql.DataFrame):Boolean = {\n  val sortedColumns1 = df1.columns.sorted\n  val h1 = sortedColumns1.head\n  val t1 = sortedColumns1.tail\n  val df1Sorted = df1.select(h1, t1:_*).orderBy(h1, t1:_*).limit(10000)\n\n  val sortedColumns2 = df2.columns.sorted\n  val h2 = sortedColumns2.head\n  val t2 = sortedColumns2.tail\n  val df2Sorted = df2.select(h2, t2:_*).orderBy(h2, t2:_*).limit(10000)\n  \n  return compareDataFrames(roundDataFrame(df1Sorted), roundDataFrame(df2Sorted), testColumnOrder=true, testNullable=false)\n}\n\ndisplayHTML(\"Finalizing the learning environment...\")\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "44984dd1-9b9c-47f3-aa1f-8fae019f9dbc", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "34fccaa3-6dee-408b-8813-886342a9ae5e", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "77739c9c-2c59-4fa0-b4ab-5c9ba47d4db2", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Classroom-Setup", "origId": 0, "version": "NotebookV1"}