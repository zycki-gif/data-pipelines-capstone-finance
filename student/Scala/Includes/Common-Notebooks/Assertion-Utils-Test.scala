{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Assertion-Utils-Test\nThe purpose of this notebook is to faciliate testing of assertions.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "8056d393-8f87-44b0-b14e-bfab4616610d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c1cc599b-4b1a-4a88-bb51-85a828f978ee", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "df86d5f6-1c37-466d-992e-f774b3d9848a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1d5b5090-ea49-45ba-bc00-2a2ffbfa9202", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "bc312c15-159d-4112-be83-b9608baf86d8", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "658c960e-36a5-4f7b-9f42-1c73ae3ee60c", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d5c33926-c52b-47db-bad1-f94f662afaef", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "6ad8c50c-e70c-4fea-8dad-4c3c6caf3d56", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# TestSuite", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "1df19d17-4e33-4510-8d00-be53d004c349", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f091b2a2-d8b8-4d96-9341-ea855db460d5", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "println(s\"Score:      ${TestResultsAggregator.score}\")\nprintln(s\"Max Score:  ${TestResultsAggregator.maxScore}\")\nprintln(s\"Percentage: ${TestResultsAggregator.percentage}\")\n\nprintln(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ac15cf8b-f4ae-4a0a-98d0-b18194a37806", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e643d08f-1384-49da-9068-0e694b7b23ea", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteA = TestSuite()\nsuiteA.test(\"ScalaTest-1\", s\"My first scala test\",  testFunction = () => true)\nsuiteA.test(\"ScalaTest-2\", s\"My second scala test\", testFunction = () => false)\nsuiteA.test(\"ScalaTest-3\", null,                    testFunction = () => true)\nsuiteA.test(\"ScalaTest-4\", s\"My fourth scala test\", testFunction = () => false)\n\nfor (testResult <- suiteA.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status}\")\n}\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${suiteA.score}\")\nprintln(s\"Max Score:  ${suiteA.maxScore}\")\nprintln(s\"Percentage: ${suiteA.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteA.score == 2, s\"A.score: ${suiteA.score}\")\nassert(suiteA.maxScore == 4, s\"A.maxScmaxScoreore: ${suiteA.maxScore}\")\nassert(suiteA.percentage == 50, s\"A.percentage: ${suiteA.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f1b0b4bd-6fac-4216-a34d-64406a5c222d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3a4a996a-c548-446b-aa9c-3683ef406aa5", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteB = TestSuite()\nsuiteB.test(\"ScalaTest-5\", \"My fifth scala test\",   () => true, points=3)\nsuiteB.testEquals(\"ScalaTest-6\", \"My sixth scala test\",   \"cat\", \"doc\", points=3)\nsuiteB.testEquals(\"ScalaTest-7\", \"My seventh scala test\", 99, 100-1,  points=3)\n\nsuiteB.testContains(\"List-Pass\", \"A list contains\",          Seq(\"dog\",\"bird\",\"cat\"), \"cat\",  points=3)\nsuiteB.testContains(\"List-Fail\", \"A list does not contain\",  Seq(\"dog\",\"bird\",\"cat\"), \"cow\",  points=3)\n\nsuiteB.testFloats(\"Floats-Pass\", \"Floats that match\",        1.001, 1.002, 0.01,  points=3)\nsuiteB.testFloats(\"Floats-Fail\", \"Floats that do not match\", 1.001, 1.002, 0.001, points=3)\n\nval dfA = Seq((\"Duck\", 10000), (\"Mouse\", 60000)).toDF(\"LastName\", \"MaxSalary\")\nval dfB = Seq((\"Duck\", 10000), (\"Chicken\", 60000)).toDF(\"LastName\", \"MaxSalary\")\nval dfC = Seq((\"Duck\", 10000), (\"Mouse\", 60000)).toDF(\"LastName\", \"MaxSalary\")\n\nsuiteB.testRows(\"Rows-Pass\", \"Rows that match\",        dfA.collect()(0), dfB.collect()(0) )\nsuiteB.testRows(\"Rows-Fail\", \"Rows that do not match\", dfA.collect()(1), dfB.collect()(1) )\n\nsuiteB.testDataFrames(\"DF-Pass\", \"DataFrames that match\",        dfA, dfC, true, true)\nsuiteB.testDataFrames(\"DF-Fail\", \"DataFrames that do not match\", dfA, dfB, true, true )\n\n//////////////////////////////////////////\n// Print the reulsts\nprintln(\"-\"*80)\nfor (testResult <- suiteB.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status} (${testResult.points}/${testResult.test.points})\")\n}\n\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${suiteB.score}\")\nprintln(s\"Max Score:  ${suiteB.maxScore}\")\nprintln(s\"Percentage: ${suiteB.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteB.score == 14, s\"B.score: ${suiteB.score}\")\nassert(suiteB.maxScore == 25, s\"B.maxScore: ${suiteB.maxScore}\")\nassert(suiteB.percentage == 56, s\"B.percentage: ${suiteB.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d4c958c9-20c9-4d4c-88c1-42b0843fc2b6", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2a1b9c97-9d96-46d1-af20-1921929469e2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteC = TestSuite()\n\nprintln(s\"Score:      ${suiteC.score}\")\nprintln(s\"Max Score:  ${suiteC.maxScore}\")\nprintln(s\"Percentage: ${suiteC.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteC.score == 0, s\"C.score: ${suiteC.score}\")\nassert(suiteC.maxScore == 0, s\"C.maxScore: ${suiteC.maxScore}\")\nassert(suiteC.percentage == 0, s\"C.percentage: ${suiteC.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "bdcdd2e9-eea4-4a2d-b8ab-7ab476ede52b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "63fe1ab1-cd5b-48b8-93c7-a95c8e34b486", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteA.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "34143524-6969-4ab9-bfa4-58e36dfe5ddb", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3f2ae367-d25c-46bd-b703-5fc85126ddbf", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteB.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "24ec441e-0f4d-4862-a66d-cb1053e083bd", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9aceeb7f-bfe4-4697-9745-337d68d32799", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteC.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5f6762b8-1373-4698-8816-e9e2c49bca5a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ca76f3d5-57e7-4904-bccf-28b60b53ba68", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "for ( (key, testResult) <- TestResultsAggregator.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status} (${testResult.points})\")\n}\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${TestResultsAggregator.score}\")\nprintln(s\"Max Score:  ${TestResultsAggregator.maxScore}\")\nprintln(s\"Percentage: ${TestResultsAggregator.percentage}\")\n\nprintln(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "8134f914-91f1-436f-8e10-f844bfb1a9ff", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ecbf8e94-6e6f-4757-a04b-add2d9d8a903", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "TestResultsAggregator.displayResults", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b4b5d32c-8ad9-4b51-92f4-60fa17cf64a8", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9eca82ed-daa4-4db6-84de-874245f33b32", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert(TestResultsAggregator.score == 16, s\"TR.score: ${TestResultsAggregator.score}\")\nassert(TestResultsAggregator.maxScore == 29, s\"TR.maxScore: ${TestResultsAggregator.maxScore}\")\nassert(TestResultsAggregator.percentage == 55, s\"TR.percentage: ${TestResultsAggregator.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "4e79dabc-7325-4c44-9a09-3b699fb42e15", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "55f4a6a2-e177-4722-8159-e5e08d264c2f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteX = TestSuite()\n\ntry {\n  suiteX.test(null, null, () => true)\n  throw new Exception(\"Expexted an IllegalArgumentException\")\n} catch {\n  case e:IllegalArgumentException => ()\n}\n\ntry {\n  suiteX.test(\"abc\", null, () => true)\n  suiteX.test(\"abc\", null, () => true)\n  throw new Exception(\"Expexted an IllegalArgumentException\")\n} catch {\n  case e:IllegalArgumentException => ()\n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2823dcc0-2daf-41aa-bff3-3e5ff27c4e4a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2526402f-6d7c-41e8-9649-14ebd2f96678", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 16, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# dbTest()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "844c99a4-43ca-4be8-bf19-ce82eec97b8c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f0209b09-e53b-4002-8a3d-92418afeb080", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 17, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "dbTest(\"ScalaTest-1\", \"cat\", \"cat\")\n\ntry {\n  dbTest(\"ScalaTest-2\", \"cat\", \"dog\")  \n} catch {\n  case _: AssertionError => ()\n}\n// dbTest(\"ScalaTest-3\", 999, 666)  ", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "4d3a0619-3d5e-4799-91ca-710324bb51de", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e9c06889-51f1-4e62-b649-161cc7510de5", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 18, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareFloats\n\n```compareFloats(floatA, floatB, tolerance)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "99754dd8-f98f-4b26-863d-5f80eccac30c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e1bf6a4e-91de-4732-bc0b-2996c5fd1225", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 19, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert(compareFloats(1, 1.toInt) == true)\n\nassert(compareFloats(100.001, 100.toInt) == true)\nassert(compareFloats(100.001, 100.toLong) == true)\nassert(compareFloats(100.001, 100.toFloat) == true)\nassert(compareFloats(100.001, 100.toDouble) == true)\n\nassert(compareFloats(100.toInt, 100.001) == true)\nassert(compareFloats(100.toLong, 100.001) == true)\nassert(compareFloats(100.toFloat, 100.001) == true)\nassert(compareFloats(100.toDouble, 100.001) == true)\n\nassert(compareFloats(100.001, \"blah\") == false)\nassert(compareFloats(\"blah\", 100.001) == false)\n\nassert(compareFloats(1.0, 1.0) == true)\n\nassert(compareFloats(1.0, 1.2, .0001) == false)\nassert(compareFloats(1.0, 1.02, .0001) == false)\nassert(compareFloats(1.0, 1.002, .0001) == false)\nassert(compareFloats(1.0, 1.0002, .0001) == false)\nassert(compareFloats(1.0, 1.00002, .0001) == true)\nassert(compareFloats(1.0, 1.000002, .0001) == true)\n\nassert(compareFloats(1.2, 1.0, .0001) == false)\nassert(compareFloats(1.02, 1.0, .0001) == false)\nassert(compareFloats(1.002, 1.0, .0001) == false)\nassert(compareFloats(1.0002, 1.0, .0001) == false)\nassert(compareFloats(1.00002, 1.0, .0001) == true)\nassert(compareFloats(1.000002, 1.0, .0001) == true)\n\nassert(compareFloats(1, null) == false)\nassert(compareFloats(null, 1) == false)\nassert(compareFloats(null, null) == true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b8e33f1f-9285-4a4b-8ca6-45736ac89ce2", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "cc9de4d5-993c-4763-af76-0345e252dbd1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 20, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareSchemas\n\n```compareSchemas(schemaA, schemaB, testColumnOrder=True, testNullable=False)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a907f719-3ae2-4c98-8009-fd82c4ce3bb2", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8565af78-9bf6-45dd-90b5-b89a3b369cf3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 21, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "import org.apache.spark.sql.types._ \nval _expectedSchema = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", DoubleType, true)\n  ))\n\nval _studentSchema1 = StructType(List(\n  StructField(\"MaxSalary\", DoubleType, true),\n  StructField(\"LastName\", StringType, true)\n  ))\n\nval _studentSchema2 = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", BooleanType, true)\n  ))\n\nval _studentSchema3 = StructType(List(\n  StructField(\"LastName\", StringType, false),\n  StructField(\"MaxSalary\", DoubleType, true)\n))\n\nval _studentSchema4 = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", DoubleType, true),\n  StructField(\"Country\", StringType, true)\n  ))\n\nassert(compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=false, testNullable=true) == true,  \"out of order, ignore order\")\nassert(compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=true, testNullable=true) == false,  \"out of order, preserve order\")\nassert(compareSchemas(_expectedSchema, _studentSchema2, testColumnOrder=false, testNullable=true) == false, \"different types\")\n\nassert(compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=true, testNullable=true) == false,  \"check nullable\")  \nassert(compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=true, testNullable=false) == true,  \"don't check nullable\")\n\nassert(compareSchemas(_expectedSchema, _studentSchema4, testColumnOrder=true, testNullable=true) == false,  \"left side < right size\")\nassert(compareSchemas(_studentSchema4, _expectedSchema, testColumnOrder=true, testNullable=true) == false,  \"left side > right side\")\n\nassert(compareSchemas(null,            _studentSchema3, testColumnOrder=true, testNullable=true) == false, \"Null schemaA\")\nassert(compareSchemas(null,            null,            testColumnOrder=true, testNullable=true) == true,  \"Null schemaA and schemaB\")\nassert(compareSchemas(_studentSchema2, null,            testColumnOrder=true, testNullable=true) == false, \"Null schemaB\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d2e77f05-c2aa-4165-9adb-b8ed2273a10d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2daae37c-4510-4383-b4ef-9725ea409524", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 22, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareRows\n\n```compareRows(rowA, rowB)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "dddf5b1d-c7ff-4566-a721-34cbdbe1b6b8", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "03c3da71-cc22-406e-90f5-d52f32441d29", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 23, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val bla = Row(\"Duck\", 10000.0)\nbla.schema", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9785a590-dcbd-47f0-ab1e-1f0e2b723bd3", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "98bfef05-94fd-4c31-bd10-f5966e87788d", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 24, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val df1 = Seq((\"Duck\", 10000.0), (\"Mouse\", 60000.0)).toDF(\"LastName\", \"MaxSalary\")\nval _rowA = df1.collect()(0)\nval _rowB = df1.collect()(1)\n\nval df2 = Seq((10000.0, \"Duck\")).toDF(\"MaxSalary\", \"LastName\")\nval _rowC = df2.collect()(0)\n\nval df3 = Seq((\"Duck\", 10000.0, \"Anaheim\")).toDF(\"LastName\", \"MaxSalary\", \"City\")\nval _rowD = df3.collect()(0)\n\n// no schema!\nval _rowE =  Row(\"Duck\", 10000.0)\nval _rowF =  Row(\"Mouse\", 60000.0)\n\nassert(compareRows(_rowA, _rowB) == false)                   // different schemas\nassert(compareRows(_rowA, _rowA) == true)                    // compare to self\nassert(compareRows(_rowA, _rowC) == true)                    // order reversed\nassert(compareRows(null, _rowA) == false, \"null _rowA\")      // Null rowA\nassert(compareRows(null, null) == true, \"null _rowA, rowB\")  // Null rowA and rowB\nassert(compareRows(_rowA, null) == false, \"null _rowB\")      // Null rowB\nassert(compareRows(_rowA, _rowD) == false)                   // _rowA smaller than _rowD\nassert(compareRows(_rowD, _rowA) == false)                   // _rowD smaller than _rowA \nassert(compareRows(_rowE, _rowF) == false)                   // no schemas, different\nassert(compareRows(_rowE, _rowE) == true)                    // no schemas, same\nassert(compareRows(_rowE, _rowA) == true)                    // no schemas / schema, same content\nassert(compareRows(_rowE, _rowB) == false)                    // no schemas / schema, different content\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6f5c4718-49fb-48b4-8aad-5b2ee876a382", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9a9e79f1-e083-4a07-8636-79602ab45d3b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 25, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "2a4a2bcf-117b-4a8f-9245-87685802b209", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Assertion-Utils-Test", "origId": 0, "version": "NotebookV1"}