{"commands": [{"bindings": {}, "collapsed": false, "command": "\nval courseType = \"sp\"\nval courseAdvertisements = scala.collection.mutable.Map[String,(String,String,String)]()\n\ndisplayHTML(\"Preparing the Scala environment...\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a137479c-6f6c-44d7-9bd7-b7b3be4d781a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c9d50f8a-28d2-475d-9e1a-869e803e0332", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5fea9f0e-c782-47e5-8996-302ddefb7139", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "195a7b7d-ccdb-482b-b24d-6c5c3ea77ddc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "38388f4a-7177-4240-951f-a8f999dedf54", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "958c4d79-2606-48b0-bca0-98a8bca9244c", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val moduleName = getModuleName()\nval lessonName = getLessonName()\nval username = getUsername()\nval userhome = getUserhome()\nval workingDir = getWorkingDir(courseType)\nval databaseName = createUserDatabase(courseType, username, moduleName, lessonName)\n\n// ****************************************************************************\n// Advertise variables we declared for the user - there are more, but these are the common ones\n// ****************************************************************************\ncourseAdvertisements += (\"moduleName\" ->   (\"v\", moduleName,   \"No additional information was provided.\"))\ncourseAdvertisements += (\"lessonName\" ->   (\"v\", lessonName,   \"No additional information was provided.\"))\ncourseAdvertisements += (\"username\" ->     (\"v\", username,     \"No additional information was provided.\"))\ncourseAdvertisements += (\"userhome\" ->     (\"v\", userhome,     \"No additional information was provided.\"))\ncourseAdvertisements += (\"workingDir\" ->   (\"v\", workingDir,   \"No additional information was provided.\"))\ncourseAdvertisements += (\"databaseName\" -> (\"d\", databaseName, \"This is a private, per-notebook, database used to provide isolation from other users and exercises.\"))\n\n// ****************************************************************************\n// Advertise functions we declared for the user - there are more, but these are the common ones\n// ****************************************************************************\ncourseAdvertisements += (\"untilStreamIsReady\" -> (\"f\", \"name, progressions=3\", \"\"\"\n  <div>Introduced in the course <b>Structured Streaming</b>, this method blocks until the stream is actually ready for processing.</div>\n  <div>By default, it waits for 3 progressions of the stream to ensure sufficent data has been processed.</div>\"\"\"))\ncourseAdvertisements += (\"stopAllStreams\" -> (\"f\", \"\", \"\"\"\n  <div>Introduced in the course <b>Structured Streaming</b>, this method stops all active streams while providing extra exception handling.</div>\n  <div>It is functionally equivilent to:<div>\n  <div><code>for (s <- spark.streams.active) s.stop()</code></div>\"\"\"))\n\ndisplayHTML(\"Defining custom variables for this lesson...\")\n\n// ****************************************************************************\n// Advertise are done here 100% of the time so that the are consistently \n// formatted. If left to each lesson, the meta data associated to each has to \n// be maintained in dozens of different places. This means that if a course\n// developer doesn't use a variable/function, then can simply suppress it later\n// by setting com.databricks.training.suppress.{key} to \"true\"\n// ****************************************************************************", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5f90aa50-80dd-4455-b7f5-16dfb0235b71", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a6051927-82a6-4d6f-8d20-a7fafcbdfc29", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b04b4da2-a4bc-4530-9ace-e65d421a686d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0df2ac05-16d0-4658-b50c-b2447f9191d6", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b4c9417e-3424-408f-b843-3e475f185177", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1112665d-718e-4ac4-bdf8-967eb526e4f9", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dataset-Mounts", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "60670014-3fc2-4cb5-86f2-6a2db6e9af67", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1460179a-9d4c-4c65-83df-81c2e8d3febd", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, courseType, username, moduleName, lessonName, false)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "fecd9f98-ff4c-4fa0-9b06-796b9f4abd8b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1808f069-68dd-462a-9a92-b8c038e6b058", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assertDbrVersion(spark.conf.get(\"com.databricks.training.expected-dbr\", null))\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "7657f39b-a007-4b5f-8336-ec4d9a5fecf4", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "16947ec6-c481-41e6-8152-78611f945e07", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "b9767341-63c8-4412-8b88-261af5f54eb4", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Common", "origId": 0, "version": "NotebookV1"}