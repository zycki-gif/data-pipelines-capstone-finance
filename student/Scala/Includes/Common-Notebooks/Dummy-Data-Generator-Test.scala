{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Dummy-Data-Generator-Test\nThe purpose of this notebook is to faciliate testing of the dummy data generator.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d1ae8f79-0999-4a94-b99c-e396156117a1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "76a4fcb9-961a-45ce-8363-fb177be2b494", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b93b6b8b-84d8-4de1-a7d8-fa8f45b5e388", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f5498395-88bf-4f99-9264-1a4625752110", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "57c978a1-bac1-4e23-8758-fe7004ea4b10", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "aaafdbe2-960c-4633-b391-30b63872ffc3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "758194b3-68d3-45c2-9f31-deba0c4a22bc", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "58a24fa3-c4e3-45f9-aad0-f24760f7a2a3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val courseType = \"test\"\nval moduleName = getModuleName()\nval lessonName = getLessonName()\nval username = getUsername()\nval userhome = getUserhome()\nval workingDir = getWorkingDir(courseType)\nval databaseName = createUserDatabase(courseType, username, moduleName, lessonName)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5810816e-b66a-4bc4-bc12-43e90a7b9c6b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f03049e2-36dc-44cd-b1a1-27869528315b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0b892cfa-353a-41f9-88e0-8660b991a5ec", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9a4e7ee7-ad1b-4479-b265-beee099e1880", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// Initialize the username\nspark.conf.set(\"com.databricks.training.username\", \"test\")\nspark.conf.set(\"com.databricks.training.userhome\", \"dbfs:/user/test\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "60867184-015c-4723-9c27-5082fbba8a0f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "da8f30c9-b26a-48ba-8f71-0d2ac6007f95", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// name: String = \"Name\", \n// id: String = \"ID\", \n// password: String = \"Password\", \n// amount: String = \"Amount\", \n// percent: String = \"Percent\", \n// probability: String = \"Probability\", \n// yesNo: String = \"YesNo\", \n// UTCTime: String = \"UTCTime\"\nimport org.apache.spark.sql.types.{StringType, DoubleType, IntegerType, BooleanType, LongType}\n\n// default rows\nval testDefaultRowsDF = new DummyData(\"test_1_scala\").toDF\nassert(testDefaultRowsDF.count == 300)\n\n// custom rows\nval testCustomRowsDF = new DummyData(\"test_2_scala\", numRows=50).toDF\nassert(testCustomRowsDF.count == 50)\n\n// custom field names\nval testCustomField1DF = new DummyData(\"test_3_scala\").addNames(\"EmployeeName\").toDF\nval fields1 = testCustomField1DF.schema.names \nassert(fields1.contains(\"EmployeeName\"))\nassert(testCustomField1DF.schema.fields(1).dataType == StringType)\n\nval testCustomField2DF = new DummyData(\"test_4_scala\").renameId(\"EmployeeID\").toDF\nval fields2 = testCustomField2DF.schema.names \nassert(fields2.contains(\"EmployeeID\"))\nassert(testCustomField2DF.schema.fields(0).dataType == LongType)\n\nval testCustomField3DF = new DummyData(\"test_5_scala\").addPasswords(\"Yak\").toDF\nval fields3 = testCustomField3DF.schema.names\nassert(testCustomField3DF.schema.fields(1).dataType == StringType)\nassert(fields3.contains(\"Yak\"))\n\nval testCustomField4DF = new DummyData(\"test_6_scala\").addDoubles(\"Salary\").toDF\nval fields4 = testCustomField4DF.schema.names \nassert(testCustomField4DF.schema.fields(1).dataType == DoubleType)\nassert(fields4.contains(\"Salary\"))\n\nval testCustomField5DF = new DummyData(\"test_7_scala\").addIntegers(\"ZeroTo100\").toDF\nval fields5 = testCustomField5DF.schema.names \nassert(testCustomField5DF.schema.fields(1).dataType == IntegerType)\nassert(fields5.contains(\"ZeroTo100\"))\n\nval testCustomField6DF = new DummyData(\"test_8_scala\").addProportions(\"Prob\").toDF\nval fields6 = testCustomField6DF.schema.names \nassert(testCustomField6DF.schema.fields(1).dataType == DoubleType)\nassert(fields6.contains(\"Prob\")) \n\nval testCustomField7DF = new DummyData(\"test_9_scala\").addBooleans(\"isOK\").toDF\nval fields7 = testCustomField7DF.schema.names \nassert(testCustomField7DF.schema.fields(1).dataType == BooleanType)\nassert(fields7.contains(\"isOK\"))\n\nval testCustomField8DF = new DummyData(\"test_10_scala\").addTimestamps(\"Timestamp\").toDF\nval fields8 = testCustomField8DF.schema.names \nassert(testCustomField8DF.schema.fields(1).dataType == IntegerType)\nassert(fields8.contains(\"Timestamp\"))\n\n// all custome field names, custom rows\nval testCustomFieldsDF = new DummyData(\"test_11_scala\", numRows=50)\n    .addNames(\"EmployeeName\")\n    .renameId(\"EmployeeID\")\n    .addPasswords(\"Yak\")\n    .addDoubles(\"Salary\")\n    .addIntegers(\"ZeroTo100\")\n    .addProportions(\"Prob\")\n    .addBooleans(\"isOK\")\n    .addTimestamps(\"Timestamp\")\n    .toDF\nval fields = testCustomFieldsDF.schema.names\nassert(fields.deep == Array(\"EmployeeID\", \"EmployeeName\", \"Yak\", \"Salary\", \"ZeroTo100\", \"Prob\", \"isOK\", \"Timestamp\").deep)\nassert(testCustomFieldsDF.count == 50)\nassert(testCustomFieldsDF.schema.fields(0).dataType == LongType)\nassert(testCustomFieldsDF.schema.fields(1).dataType == StringType)\nassert(testCustomFieldsDF.schema.fields(2).dataType == StringType)\nassert(testCustomFieldsDF.schema.fields(3).dataType == DoubleType)\nassert(testCustomFieldsDF.schema.fields(4).dataType == IntegerType)\nassert(testCustomFieldsDF.schema.fields(5).dataType == DoubleType)\nassert(testCustomFieldsDF.schema.fields(6).dataType == BooleanType)\nassert(testCustomFieldsDF.schema.fields(7).dataType == IntegerType)\n\n// needs to be done: restructure testing format to match class-utility-methods\n// needs to be done: add unit testing for the DummyData.add*() methods and their parameters\n// needs to be done: add value testing", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6465161d-c279-4696-b6b8-9700464e4f86", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8c0f121b-0534-4692-8fc0-a11a7193b725", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.sql(s\"DROP DATABASE IF EXISTS $databaseName CASCADE\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "df88655d-e648-4a7c-bb54-96d36163ab95", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "88f36d66-430c-48be-8a3f-1bd4188c8e65", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9773bd94-ba9a-4b52-b226-2dd2bf0c8b54", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1db3bf61-d2d9-44cc-a8e0-d2ab13a9ec67", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "091d1d11-bc96-4dd2-bea2-9fb95f7d6563", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Dummy-Data-Generator-Test", "origId": 0, "version": "NotebookV1"}