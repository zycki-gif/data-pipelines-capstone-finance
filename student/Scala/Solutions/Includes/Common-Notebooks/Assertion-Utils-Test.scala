{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Assertion-Utils-Test\nThe purpose of this notebook is to faciliate testing of assertions.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "80651d5f-df16-4d76-be35-14be73cd5127", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "de43d47d-3592-457b-bb73-1cc74375fe39", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "49e6d87c-c7ad-412d-b7cc-0483a594b4cf", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "45cd62e4-daaf-4118-9f39-a1ee381cb51f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "959be631-f6ff-4332-85a0-086c810517ef", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "69d9a8b6-707e-44e3-b46a-1b0620b9ed6b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "69d43a3c-1a09-488b-91db-016e99713388", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "745423c9-9f7d-49c8-b32d-d9a71ed57506", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# TestSuite", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5b90c346-9ec0-4d6f-917a-b58c8b007e82", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fea98dac-1d54-484f-be18-9e4daf70fa7b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "println(s\"Score:      ${TestResultsAggregator.score}\")\nprintln(s\"Max Score:  ${TestResultsAggregator.maxScore}\")\nprintln(s\"Percentage: ${TestResultsAggregator.percentage}\")\n\nprintln(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a8706ab4-5b4d-45f4-aea3-ae4f91d4a8f1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "71b63f9c-855e-44d9-818c-3c0d04628063", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteA = TestSuite()\nsuiteA.test(\"ScalaTest-1\", s\"My first scala test\",  testFunction = () => true)\nsuiteA.test(\"ScalaTest-2\", s\"My second scala test\", testFunction = () => false)\nsuiteA.test(\"ScalaTest-3\", null,                    testFunction = () => true)\nsuiteA.test(\"ScalaTest-4\", s\"My fourth scala test\", testFunction = () => false)\n\nfor (testResult <- suiteA.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status}\")\n}\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${suiteA.score}\")\nprintln(s\"Max Score:  ${suiteA.maxScore}\")\nprintln(s\"Percentage: ${suiteA.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteA.score == 2, s\"A.score: ${suiteA.score}\")\nassert(suiteA.maxScore == 4, s\"A.maxScmaxScoreore: ${suiteA.maxScore}\")\nassert(suiteA.percentage == 50, s\"A.percentage: ${suiteA.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ee748162-ac78-4984-bc94-75cfb67028e5", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "cc63535d-b2d0-4591-96aa-6cd8361971cd", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteB = TestSuite()\nsuiteB.test(\"ScalaTest-5\", \"My fifth scala test\",   () => true, points=3)\nsuiteB.testEquals(\"ScalaTest-6\", \"My sixth scala test\",   \"cat\", \"doc\", points=3)\nsuiteB.testEquals(\"ScalaTest-7\", \"My seventh scala test\", 99, 100-1,  points=3)\n\nsuiteB.testContains(\"List-Pass\", \"A list contains\",          Seq(\"dog\",\"bird\",\"cat\"), \"cat\",  points=3)\nsuiteB.testContains(\"List-Fail\", \"A list does not contain\",  Seq(\"dog\",\"bird\",\"cat\"), \"cow\",  points=3)\n\nsuiteB.testFloats(\"Floats-Pass\", \"Floats that match\",        1.001, 1.002, 0.01,  points=3)\nsuiteB.testFloats(\"Floats-Fail\", \"Floats that do not match\", 1.001, 1.002, 0.001, points=3)\n\nval dfA = Seq((\"Duck\", 10000), (\"Mouse\", 60000)).toDF(\"LastName\", \"MaxSalary\")\nval dfB = Seq((\"Duck\", 10000), (\"Chicken\", 60000)).toDF(\"LastName\", \"MaxSalary\")\nval dfC = Seq((\"Duck\", 10000), (\"Mouse\", 60000)).toDF(\"LastName\", \"MaxSalary\")\n\nsuiteB.testRows(\"Rows-Pass\", \"Rows that match\",        dfA.collect()(0), dfB.collect()(0) )\nsuiteB.testRows(\"Rows-Fail\", \"Rows that do not match\", dfA.collect()(1), dfB.collect()(1) )\n\nsuiteB.testDataFrames(\"DF-Pass\", \"DataFrames that match\",        dfA, dfC, true, true)\nsuiteB.testDataFrames(\"DF-Fail\", \"DataFrames that do not match\", dfA, dfB, true, true )\n\n//////////////////////////////////////////\n// Print the reulsts\nprintln(\"-\"*80)\nfor (testResult <- suiteB.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status} (${testResult.points}/${testResult.test.points})\")\n}\n\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${suiteB.score}\")\nprintln(s\"Max Score:  ${suiteB.maxScore}\")\nprintln(s\"Percentage: ${suiteB.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteB.score == 14, s\"B.score: ${suiteB.score}\")\nassert(suiteB.maxScore == 25, s\"B.maxScore: ${suiteB.maxScore}\")\nassert(suiteB.percentage == 56, s\"B.percentage: ${suiteB.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0beabd9e-d572-41ec-8e1a-e3412650ca2c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8240e064-4552-4cd8-96f6-de4dc560da67", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteC = TestSuite()\n\nprintln(s\"Score:      ${suiteC.score}\")\nprintln(s\"Max Score:  ${suiteC.maxScore}\")\nprintln(s\"Percentage: ${suiteC.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteC.score == 0, s\"C.score: ${suiteC.score}\")\nassert(suiteC.maxScore == 0, s\"C.maxScore: ${suiteC.maxScore}\")\nassert(suiteC.percentage == 0, s\"C.percentage: ${suiteC.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cdf256fd-81c3-45d0-b086-acd373816431", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8b4ab706-0478-4956-b1f7-c879895a30be", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteA.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "269f3258-bc39-4bdf-b752-d851cccaa07d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7a7f0afb-7865-4ff1-af67-c4463b5c7bec", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteB.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f85cf9ca-bd67-44e9-a76a-52c30279ba98", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "25cb5b20-a3e0-47cd-8cb1-8adbccb5bc76", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteC.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9bddc001-8b69-4d61-923b-c387049dff19", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4c53997f-92a5-41ed-b3fc-2704ff1a003f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "for ( (key, testResult) <- TestResultsAggregator.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status} (${testResult.points})\")\n}\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${TestResultsAggregator.score}\")\nprintln(s\"Max Score:  ${TestResultsAggregator.maxScore}\")\nprintln(s\"Percentage: ${TestResultsAggregator.percentage}\")\n\nprintln(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "7abd1cc3-afc5-4dd0-badd-6c264b963f64", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9be622d0-53d9-4dca-977b-cdc87da01e57", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "TestResultsAggregator.displayResults", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "60e2aa4f-f588-452e-bbab-0523cc9ffab3", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f1063201-31d7-435b-b05a-a2095009f316", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert(TestResultsAggregator.score == 16, s\"TR.score: ${TestResultsAggregator.score}\")\nassert(TestResultsAggregator.maxScore == 29, s\"TR.maxScore: ${TestResultsAggregator.maxScore}\")\nassert(TestResultsAggregator.percentage == 55, s\"TR.percentage: ${TestResultsAggregator.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "19b5e2ed-d484-494b-9d43-ba8c46f253fc", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "204256aa-9e43-4497-bff1-3f917b4ecfa9", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteX = TestSuite()\n\ntry {\n  suiteX.test(null, null, () => true)\n  throw new Exception(\"Expexted an IllegalArgumentException\")\n} catch {\n  case e:IllegalArgumentException => ()\n}\n\ntry {\n  suiteX.test(\"abc\", null, () => true)\n  suiteX.test(\"abc\", null, () => true)\n  throw new Exception(\"Expexted an IllegalArgumentException\")\n} catch {\n  case e:IllegalArgumentException => ()\n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9936f37a-ea27-455a-8ce1-1fec0e3ba4e1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "56167683-eaff-4599-a77d-2796bfca95bc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 16, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# dbTest()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "141fefe2-a5de-4f6d-952d-2b47a558631e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "569a53ff-70bb-4e51-8a75-fbdbad1c036b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 17, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "dbTest(\"ScalaTest-1\", \"cat\", \"cat\")\n\ntry {\n  dbTest(\"ScalaTest-2\", \"cat\", \"dog\")  \n} catch {\n  case _: AssertionError => ()\n}\n// dbTest(\"ScalaTest-3\", 999, 666)  ", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "52eaae8b-e855-4b49-a1af-4626fdb62eab", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2ba61bce-655d-4b38-a17f-706b1873e323", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 18, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareFloats\n\n```compareFloats(floatA, floatB, tolerance)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ae11202d-a13c-43df-bee7-d3e22b837a8f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ff5159ab-ad1f-4851-ba2d-74f653e1ce8b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 19, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert(compareFloats(1, 1.toInt) == true)\n\nassert(compareFloats(100.001, 100.toInt) == true)\nassert(compareFloats(100.001, 100.toLong) == true)\nassert(compareFloats(100.001, 100.toFloat) == true)\nassert(compareFloats(100.001, 100.toDouble) == true)\n\nassert(compareFloats(100.toInt, 100.001) == true)\nassert(compareFloats(100.toLong, 100.001) == true)\nassert(compareFloats(100.toFloat, 100.001) == true)\nassert(compareFloats(100.toDouble, 100.001) == true)\n\nassert(compareFloats(100.001, \"blah\") == false)\nassert(compareFloats(\"blah\", 100.001) == false)\n\nassert(compareFloats(1.0, 1.0) == true)\n\nassert(compareFloats(1.0, 1.2, .0001) == false)\nassert(compareFloats(1.0, 1.02, .0001) == false)\nassert(compareFloats(1.0, 1.002, .0001) == false)\nassert(compareFloats(1.0, 1.0002, .0001) == false)\nassert(compareFloats(1.0, 1.00002, .0001) == true)\nassert(compareFloats(1.0, 1.000002, .0001) == true)\n\nassert(compareFloats(1.2, 1.0, .0001) == false)\nassert(compareFloats(1.02, 1.0, .0001) == false)\nassert(compareFloats(1.002, 1.0, .0001) == false)\nassert(compareFloats(1.0002, 1.0, .0001) == false)\nassert(compareFloats(1.00002, 1.0, .0001) == true)\nassert(compareFloats(1.000002, 1.0, .0001) == true)\n\nassert(compareFloats(1, null) == false)\nassert(compareFloats(null, 1) == false)\nassert(compareFloats(null, null) == true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "74e8c591-de85-452a-a99c-a7b5821fe8c7", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ab9fb485-35c7-4cb9-a014-902642d31545", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 20, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareSchemas\n\n```compareSchemas(schemaA, schemaB, testColumnOrder=True, testNullable=False)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0a831c46-06d4-4c3c-940f-ad5cd0a5dd51", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7a04a158-7ecd-464a-a495-d3f9ace1b5e2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 21, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "import org.apache.spark.sql.types._ \nval _expectedSchema = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", DoubleType, true)\n  ))\n\nval _studentSchema1 = StructType(List(\n  StructField(\"MaxSalary\", DoubleType, true),\n  StructField(\"LastName\", StringType, true)\n  ))\n\nval _studentSchema2 = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", BooleanType, true)\n  ))\n\nval _studentSchema3 = StructType(List(\n  StructField(\"LastName\", StringType, false),\n  StructField(\"MaxSalary\", DoubleType, true)\n))\n\nval _studentSchema4 = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", DoubleType, true),\n  StructField(\"Country\", StringType, true)\n  ))\n\nassert(compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=false, testNullable=true) == true,  \"out of order, ignore order\")\nassert(compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=true, testNullable=true) == false,  \"out of order, preserve order\")\nassert(compareSchemas(_expectedSchema, _studentSchema2, testColumnOrder=false, testNullable=true) == false, \"different types\")\n\nassert(compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=true, testNullable=true) == false,  \"check nullable\")  \nassert(compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=true, testNullable=false) == true,  \"don't check nullable\")\n\nassert(compareSchemas(_expectedSchema, _studentSchema4, testColumnOrder=true, testNullable=true) == false,  \"left side < right size\")\nassert(compareSchemas(_studentSchema4, _expectedSchema, testColumnOrder=true, testNullable=true) == false,  \"left side > right side\")\n\nassert(compareSchemas(null,            _studentSchema3, testColumnOrder=true, testNullable=true) == false, \"Null schemaA\")\nassert(compareSchemas(null,            null,            testColumnOrder=true, testNullable=true) == true,  \"Null schemaA and schemaB\")\nassert(compareSchemas(_studentSchema2, null,            testColumnOrder=true, testNullable=true) == false, \"Null schemaB\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0b376138-6149-49f2-a7b2-b687c905c4d0", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a786e6bb-910b-4cfe-a62e-77be6aad7f74", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 22, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareRows\n\n```compareRows(rowA, rowB)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "dfeef95b-288e-4d10-a6b8-408951e3a24f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c4bc1531-fdd1-4d2f-9325-9409e28aa0b7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 23, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val bla = Row(\"Duck\", 10000.0)\nbla.schema", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9a21597f-2c3d-4091-8a69-78c712649423", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3bf835a6-daed-4f7e-91ba-0a0bb70f3e21", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 24, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val df1 = Seq((\"Duck\", 10000.0), (\"Mouse\", 60000.0)).toDF(\"LastName\", \"MaxSalary\")\nval _rowA = df1.collect()(0)\nval _rowB = df1.collect()(1)\n\nval df2 = Seq((10000.0, \"Duck\")).toDF(\"MaxSalary\", \"LastName\")\nval _rowC = df2.collect()(0)\n\nval df3 = Seq((\"Duck\", 10000.0, \"Anaheim\")).toDF(\"LastName\", \"MaxSalary\", \"City\")\nval _rowD = df3.collect()(0)\n\n// no schema!\nval _rowE =  Row(\"Duck\", 10000.0)\nval _rowF =  Row(\"Mouse\", 60000.0)\n\nassert(compareRows(_rowA, _rowB) == false)                   // different schemas\nassert(compareRows(_rowA, _rowA) == true)                    // compare to self\nassert(compareRows(_rowA, _rowC) == true)                    // order reversed\nassert(compareRows(null, _rowA) == false, \"null _rowA\")      // Null rowA\nassert(compareRows(null, null) == true, \"null _rowA, rowB\")  // Null rowA and rowB\nassert(compareRows(_rowA, null) == false, \"null _rowB\")      // Null rowB\nassert(compareRows(_rowA, _rowD) == false)                   // _rowA smaller than _rowD\nassert(compareRows(_rowD, _rowA) == false)                   // _rowD smaller than _rowA \nassert(compareRows(_rowE, _rowF) == false)                   // no schemas, different\nassert(compareRows(_rowE, _rowE) == true)                    // no schemas, same\nassert(compareRows(_rowE, _rowA) == true)                    // no schemas / schema, same content\nassert(compareRows(_rowE, _rowB) == false)                    // no schemas / schema, different content\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "99136aaa-21f7-4e72-a5e3-c5f337be9205", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9a5527de-bcc9-445b-8f1a-b487c001d2e7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 25, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "e0a32a2b-b84a-472f-a738-e3719f631359", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Assertion-Utils-Test", "origId": 0, "version": "NotebookV1"}