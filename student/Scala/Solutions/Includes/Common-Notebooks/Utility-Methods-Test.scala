{"commands": [{"bindings": {}, "collapsed": false, "command": "\nspark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")\n\nval courseAdvertisements = scala.collection.mutable.Map[String,(String,String,String)]()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6f42eaa1-7278-482a-a796-872182d8be9e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4f6fe83b-cd20-4367-99f7-50dfd2180b4b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d57562ae-90eb-43aa-946f-6c438de11aca", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "414a551b-ba3a-4c54-914e-25df45c4e02e", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "import scala.collection.mutable.ArrayBuffer\nval scalaTests = ArrayBuffer.empty[Boolean]\ndef functionPassed(result: Boolean) = {\n  if (result) {\n    scalaTests += true\n  } else {\n    scalaTests += false\n  } \n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "65d79781-0587-4d5a-96f9-01070df5d2a4", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a809b99e-f65e-4e7e-8488-511cce68137b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `printRecordsPerPartition`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "347b35a5-c1b4-48c7-9739-13f639bcb6d2", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "82ba2503-f140-424d-87c9-e4315e18cffe", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testPrintRecordsPerPartition(): Boolean = {\n  \n  // Import Data\n  val peopleDF = spark.read.parquet(\"/mnt/training/dataframes/people-10m.parquet\")\n  \n  // Get printed results\n  import java.io.ByteArrayOutputStream\n  val printedOutput = new ByteArrayOutputStream\n  Console.withOut(printedOutput) {printRecordsPerPartition(peopleDF)}\n  \n  // Setup tests\n  import scala.collection.mutable.ArrayBuffer\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  \n  // Test if correct number of partitions are printing\n  try {\n    assert(\n      (for (element <- printedOutput.toString.split(\"\\n\") if element.startsWith(\"#\")) yield element).size == peopleDF.rdd.getNumPartitions\n    )\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"The correct number of partitions were not identified for printRecordsPerPartition\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for the correct number of partitions were not identified for printRecordsPerPartition\")\n    }\n  }\n  \n  // Test if each printed partition has a record number associated\n  try {\n    val recordMap = for (element <- printedOutput.toString.split(\"\\n\") if element.startsWith(\"#\")) \n      yield Map(\n        element.slice(element.indexOf(\"#\") + 1, element.indexOf(\":\") - element.indexOf(\"#\")) -> element.split(\" \")(1).replace(\",\", \"\").toInt\n      )\n    val recordCounts = (for (map <- recordMap if map.keySet.toSeq(0).toInt.isInstanceOf[Int]) yield map.getOrElse(map.keySet.toSeq(0), -1))\n    recordCounts.foreach(x => assert(x.isInstanceOf[Int]))\n    recordCounts.foreach(x => assert(x != -1))\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"Not every partition has an associated record count\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for not every partition having an associated record count\")\n    }\n  }\n  \n  // Test if the sum of the printed number of records per partition equals the total number of records\n  try {\n    val printedSum = (\n      for (element <- printedOutput.toString.split(\"\\n\") if element.startsWith(\"#\")) yield element.split(\" \")(1).replace(\",\", \"\").toInt\n    ).sum\n    assert(printedSum == peopleDF.count)\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"The sum of the number of records per partition does not match the total number of records\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for the sum of the number of records per partition not matching the total number of records\")\n    }\n  }\n  \n\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for printRecordsPerPartition passed\")\n    true\n  } else {\n    println(s\"$numTestsPassed of ${testsPassed.length} tests for printRecordsPerPartition passed\")\n    false\n  }\n}\n\nfunctionPassed(testPrintRecordsPerPartition())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f63f5b3d-e919-4545-ab21-031c7033e1ef", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "deea2e36-a0e0-4daf-ab16-2002cc52fcc3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `computeFileStats`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5ef6e1b7-009d-4019-a9fb-1d37a8347d1b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e7f251d9-e728-4f7f-863b-78d54f3fade0", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testComputeFileStats(): Boolean = {\n  \n  // Set file path\n  val filePath = \"/mnt/training/global-sales/transactions/2017.parquet\"\n  \n  // Run and get output\n  val output = computeFileStats(filePath)\n  \n  // Setup tests\n  import scala.collection.mutable.ArrayBuffer\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  \n  // Test if result is correct structure\n  try {\n    assert(output.getClass.getName.startsWith(\"scala.Tuple\"))\n    assert(output.productArity == 2)\n    assert(output._1.isInstanceOf[Long])\n    assert(output._2.isInstanceOf[Long])\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"The incorrect structure is returned for computeFileStats\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for the incorrect structure being returned for computeFileStats\")\n    }\n  }\n  \n  // Test that correct result is returned\n  try {\n    assert(output._1 == 6276)\n    assert(output._2 == 1269333224)\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"The incorrect result is returned for computeFileStats\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for the incorrect result being returned for computeFileStats\")\n    }\n  }\n  \n  // Test that nonexistent file path throws error\n  try {\n    computeFileStats(\"alkshdahdnoinscoinwincwinecw/cw/cw/cd/c/wcdwdfobnwef\")\n    passedTest(false, \"A nonexistent file path did not throw an error for computeFileStats\")\n  } catch {\n    case a: java.io.FileNotFoundException => {\n      passedTest(true)\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for a nonexistent file path throwing an error for computeFileStats\")\n    }\n  }\n  \n\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for computeFileStats passed\")\n    true\n  } else {\n    println(s\"$numTestsPassed of ${testsPassed.length} tests for computeFileStats passed\")\n    false\n  }\n}\n\nfunctionPassed(testComputeFileStats())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "4013a330-e746-42e5-9f9c-2eb1b4b642d3", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "26e5446b-e660-422e-97b8-6e076e435295", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `cacheAs`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b20edd65-7c2c-4121-a282-d9a7ff2b8195", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b4f25138-eeb4-41a3-a33b-4ab5ee67bfc8", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testCacheAs(): Boolean = {\n  \n  import org.apache.spark.storage.StorageLevel\n  // Import DF\n  val inputDF = spark.read.parquet(\"/mnt/training/global-sales/transactions/2017.parquet\").limit(100)\n  \n  // Setup tests\n  import scala.collection.mutable.ArrayBuffer\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  \n  // Test uncached table gets cached\n  try {\n    cacheAs(inputDF, \"testCacheTable12344321\", StorageLevel.MEMORY_ONLY)\n    assert(spark.catalog.isCached(\"testCacheTable12344321\"))\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"Uncached table was not cached for cacheAs\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for uncached table being cached for cacheAs\")\n    }\n  }\n  \n  // Test cached table gets recached\n  try {\n    cacheAs(inputDF, \"testCacheTable12344321\", StorageLevel.MEMORY_ONLY)\n    assert(spark.catalog.isCached(\"testCacheTable12344321\"))\n    spark.catalog.uncacheTable(\"testCacheTable12344321\")\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"Cached table was not recached for cacheAs\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for cached table being recached for cacheAs\")\n    }\n  }\n\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for cacheAs passed\")\n    true\n  } else {\n    println(s\"$numTestsPassed of ${testsPassed.length} tests for cacheAs passed\")\n    false\n  }\n}\n\nfunctionPassed(testCacheAs())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "4a657b44-57db-4da1-a6f8-8a95a772c544", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "008c8e93-6b78-424f-bdbb-8fb94ae9c3f2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `benchmarkCount()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "01eec10b-7300-4764-9064-e006cce43535", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ccc13b65-cc04-4059-a76d-1bd1d3a8d693", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testBenchmarkCount(): Boolean = {\n  \n  def testFunction() = {\n    spark.createDataFrame(Seq((1, 2, 3, 4), (5, 6, 7, 8), (9, 10, 11, 12)))\n  }\n  val output = benchmarkCount(testFunction)\n  \n  // Setup tests\n  import scala.collection.mutable.ArrayBuffer\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  \n  // Test that correct structure is returned\n  try {\n    assert(output.getClass.getName.startsWith(\"scala.Tuple\"))\n    assert(output.productArity == 3)\n    assert(output._1.isInstanceOf[org.apache.spark.sql.DataFrame])\n    assert(output._2.isInstanceOf[Long])\n    assert(output._3.isInstanceOf[Long])\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"Correct structure not returned for benchmarkCount\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for correct structure being returned for benchmarkCount\")\n    }\n  }\n  \n  // Test that correct result is returned\n  try {\n    assert(output._1.rdd.collect().deep == testFunction().rdd.collect().deep)\n    assert(output._2 == testFunction().count())\n    assert(output._3 > 0)\n    assert(output._3 < 10000)\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"Uncached table was not cached for cacheAs\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for uncached table being cached for cacheAs\")\n    }\n  }\n\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for benchmarkCount passed\")\n    true\n  } else {\n    println(s\"$numTestsPassed of ${testsPassed.length} tests for benchmarkCount passed\")\n    false\n  }\n}\n\nfunctionPassed(testBenchmarkCount())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ed01ed1b-2f1d-447c-9204-ad830733dc2f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "481155cc-a21b-4f76-990a-df9a3e255a20", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test **`untilStreamIsReady()`**", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ce4bfe1e-5d4d-4692-898c-4a867f11ded1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c0132517-26be-4f79-a74c-0af201926d0e", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val dataPath = \"dbfs:/mnt/training/definitive-guide/data/activity-data-stream.json\"\nval dataSchema = \"Recorded_At timestamp, Device string, Index long, Model string, User string, _corrupt_record String, gt string, x double, y double, z double\"\n\nval initialDF = spark\n  .readStream                             // Returns DataStreamReader\n  .option(\"maxFilesPerTrigger\", 1)        // Force processing of only 1 file per trigger \n  .schema(dataSchema)                     // Required for all streaming DataFrames\n  .json(dataPath)                         // The stream's source directory and file type\n\nval name = \"Testing_123\"\n\ndisplay(initialDF, streamName = name)\nuntilStreamIsReady(name)\nassert(spark.streams.active.length == 1, \"Expected 1 active stream, found \" + spark.streams.active.length)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "bdc34afd-5efe-4ef6-aa99-0ac7eaa3fc3b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f9ca6477-51c8-478b-823c-98da1f439607", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "for (stream <- spark.streams.active) {\n  stream.stop()\n  var queries = spark.streams.active.filter(_.name == stream.name)\n  while (queries.length > 0) {\n    Thread.sleep(5*1000) // Give it a couple of seconds\n    queries = spark.streams.active.filter(_.name == stream.name)\n  }\n  println(\"\"\"The stream \"%s\" has beend terminated.\"\"\".format(stream.name))\n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2ae01e57-f2c5-4e1f-9984-dddd743ff4b8", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "bfa4a42f-8184-4158-96ba-6fbf5ff14018", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val numTestsPassed = scalaTests.groupBy(identity).mapValues(_.size)(true)\nif (numTestsPassed == scalaTests.length) {\n  println(s\"All $numTestsPassed tests for Scala passed\")\n} else {\n  println(s\"$numTestsPassed of ${scalaTests.length} tests for Scala passed\")\n  throw new Exception(s\"$numTestsPassed of ${scalaTests.length} tests for Scala passed\")\n}\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b3fb1a7f-127f-45c7-a5da-c4856a21d5ff", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fbd5ba7e-2ead-4c5e-8ef8-e2b5c1caee75", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "96a21801-b189-43f9-9237-d5bf1e880bf0", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Utility-Methods-Test", "origId": 0, "version": "NotebookV1"}