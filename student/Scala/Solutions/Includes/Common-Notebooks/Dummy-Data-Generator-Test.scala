{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Dummy-Data-Generator-Test\nThe purpose of this notebook is to faciliate testing of the dummy data generator.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2b990e67-9611-4de9-8650-ef4d85ba26b5", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f8eaef57-8c6d-48bf-a16a-f6345d397ce7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cf0ca6c0-6f68-450f-9864-11cfb8cff725", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8e9c6352-c187-437e-a72d-ae7d01291e3a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "66784dc1-83b9-4558-b746-e87efd0c5821", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "54d8aa54-761a-440e-a4b3-f7833c2fcf47", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a78e8136-00db-42e6-b240-5995a50e47bb", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9af08a99-acfe-49e1-a0db-28e6536b94b7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val courseType = \"test\"\nval moduleName = getModuleName()\nval lessonName = getLessonName()\nval username = getUsername()\nval userhome = getUserhome()\nval workingDir = getWorkingDir(courseType)\nval databaseName = createUserDatabase(courseType, username, moduleName, lessonName)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2eb0fddf-3bb1-4630-8425-4854caba0cb0", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5c069a1f-9f9d-430a-a307-5bca99e62194", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "16214acf-1e6c-433c-87a9-51551b731cfc", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "d564e184-8471-48d5-ba4d-c32a639b1d02", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// Initialize the username\nspark.conf.set(\"com.databricks.training.username\", \"test\")\nspark.conf.set(\"com.databricks.training.userhome\", \"dbfs:/user/test\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "1d9500bd-3514-4cea-93f6-7dd3ab41dfd9", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "6a6263f8-171e-4e21-961a-e9cedfc6198a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// name: String = \"Name\", \n// id: String = \"ID\", \n// password: String = \"Password\", \n// amount: String = \"Amount\", \n// percent: String = \"Percent\", \n// probability: String = \"Probability\", \n// yesNo: String = \"YesNo\", \n// UTCTime: String = \"UTCTime\"\nimport org.apache.spark.sql.types.{StringType, DoubleType, IntegerType, BooleanType, LongType}\n\n// default rows\nval testDefaultRowsDF = new DummyData(\"test_1_scala\").toDF\nassert(testDefaultRowsDF.count == 300)\n\n// custom rows\nval testCustomRowsDF = new DummyData(\"test_2_scala\", numRows=50).toDF\nassert(testCustomRowsDF.count == 50)\n\n// custom field names\nval testCustomField1DF = new DummyData(\"test_3_scala\").addNames(\"EmployeeName\").toDF\nval fields1 = testCustomField1DF.schema.names \nassert(fields1.contains(\"EmployeeName\"))\nassert(testCustomField1DF.schema.fields(1).dataType == StringType)\n\nval testCustomField2DF = new DummyData(\"test_4_scala\").renameId(\"EmployeeID\").toDF\nval fields2 = testCustomField2DF.schema.names \nassert(fields2.contains(\"EmployeeID\"))\nassert(testCustomField2DF.schema.fields(0).dataType == LongType)\n\nval testCustomField3DF = new DummyData(\"test_5_scala\").addPasswords(\"Yak\").toDF\nval fields3 = testCustomField3DF.schema.names\nassert(testCustomField3DF.schema.fields(1).dataType == StringType)\nassert(fields3.contains(\"Yak\"))\n\nval testCustomField4DF = new DummyData(\"test_6_scala\").addDoubles(\"Salary\").toDF\nval fields4 = testCustomField4DF.schema.names \nassert(testCustomField4DF.schema.fields(1).dataType == DoubleType)\nassert(fields4.contains(\"Salary\"))\n\nval testCustomField5DF = new DummyData(\"test_7_scala\").addIntegers(\"ZeroTo100\").toDF\nval fields5 = testCustomField5DF.schema.names \nassert(testCustomField5DF.schema.fields(1).dataType == IntegerType)\nassert(fields5.contains(\"ZeroTo100\"))\n\nval testCustomField6DF = new DummyData(\"test_8_scala\").addProportions(\"Prob\").toDF\nval fields6 = testCustomField6DF.schema.names \nassert(testCustomField6DF.schema.fields(1).dataType == DoubleType)\nassert(fields6.contains(\"Prob\")) \n\nval testCustomField7DF = new DummyData(\"test_9_scala\").addBooleans(\"isOK\").toDF\nval fields7 = testCustomField7DF.schema.names \nassert(testCustomField7DF.schema.fields(1).dataType == BooleanType)\nassert(fields7.contains(\"isOK\"))\n\nval testCustomField8DF = new DummyData(\"test_10_scala\").addTimestamps(\"Timestamp\").toDF\nval fields8 = testCustomField8DF.schema.names \nassert(testCustomField8DF.schema.fields(1).dataType == IntegerType)\nassert(fields8.contains(\"Timestamp\"))\n\n// all custome field names, custom rows\nval testCustomFieldsDF = new DummyData(\"test_11_scala\", numRows=50)\n    .addNames(\"EmployeeName\")\n    .renameId(\"EmployeeID\")\n    .addPasswords(\"Yak\")\n    .addDoubles(\"Salary\")\n    .addIntegers(\"ZeroTo100\")\n    .addProportions(\"Prob\")\n    .addBooleans(\"isOK\")\n    .addTimestamps(\"Timestamp\")\n    .toDF\nval fields = testCustomFieldsDF.schema.names\nassert(fields.deep == Array(\"EmployeeID\", \"EmployeeName\", \"Yak\", \"Salary\", \"ZeroTo100\", \"Prob\", \"isOK\", \"Timestamp\").deep)\nassert(testCustomFieldsDF.count == 50)\nassert(testCustomFieldsDF.schema.fields(0).dataType == LongType)\nassert(testCustomFieldsDF.schema.fields(1).dataType == StringType)\nassert(testCustomFieldsDF.schema.fields(2).dataType == StringType)\nassert(testCustomFieldsDF.schema.fields(3).dataType == DoubleType)\nassert(testCustomFieldsDF.schema.fields(4).dataType == IntegerType)\nassert(testCustomFieldsDF.schema.fields(5).dataType == DoubleType)\nassert(testCustomFieldsDF.schema.fields(6).dataType == BooleanType)\nassert(testCustomFieldsDF.schema.fields(7).dataType == IntegerType)\n\n// needs to be done: restructure testing format to match class-utility-methods\n// needs to be done: add unit testing for the DummyData.add*() methods and their parameters\n// needs to be done: add value testing", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a00da9c4-cbd6-41d3-83cc-0bb02c9c48e6", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "cea402ee-12a2-476c-8e4b-959c63893b9a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.sql(s\"DROP DATABASE IF EXISTS $databaseName CASCADE\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "90eef609-7504-4bfa-935c-3ba85b2065d1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "087fd89e-217b-43c2-80b7-ea3fa9114e06", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b6531d6e-16d3-478f-9c5b-d1c1afc8ad30", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "80764c56-cf60-4757-bedf-7558ea0c8fdf", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "f6442001-ba9c-4364-9c4c-1f45a576c226", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Dummy-Data-Generator-Test", "origId": 0, "version": "NotebookV1"}