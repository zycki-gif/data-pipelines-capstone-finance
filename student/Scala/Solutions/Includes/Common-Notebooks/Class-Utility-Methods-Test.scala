{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Class-Utility-Methods-Test\nThe purpose of this notebook is to faciliate testing of courseware-specific utility methos.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f2eb47ea-190a-400b-84f3-17995bf52ea0", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "dc309bb8-302b-435e-8bcb-07b178d3a0ce", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b6806034-de19-485c-9955-a26d8d2e75ae", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "cbfe7a03-a1a9-4007-898b-5a605880d559", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\na lot of these tests evolve around the current DBR version.\n\nIt shall be assumed that the cluster is configured properly and that these tests are updated with each publishing of courseware against a new DBR", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "1f7e72ff-c35b-43e6-9e8f-e0dcdcd88dae", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3ce2053a-206a-458b-a507-e0b190c160f2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6de44e2b-92e1-4792-b532-b8d7fe0f1a47", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5c439a79-50cc-4c61-8411-af08a35f468e", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def functionPassed(result: Boolean) = {\n  if (!result) {\n    assert(false, \"Test failed\")\n  } \n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a5bcd806-0181-4182-8e46-1111821d106d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1975c28c-afc9-40a1-a4ee-9e8ca606a7dc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getTags`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6d519b6a-e6a7-4500-b2c9-3a6a45c20273", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "498f5bff-277c-4849-afd2-492128ea6799", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetTags(): Boolean = {\n  \n  val testTags = getTags()\n  \n  import scala.collection.mutable.ArrayBuffer\n\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  // Test that tags result is correct type\n  try {\n    assert(testTags.isInstanceOf[Map[com.databricks.logging.TagDefinition,String]])\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"tags is not an instance of Map[com.databricks.logging.TagDefinition,String]\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for tags being an instance of Map[com.databricks.logging.TagDefinition,String]\")\n    }\n  }\n\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for getTags passed\")\n    true\n  } else {\n    throw new Exception(s\"$numTestsPassed of ${testsPassed.length} tests for getTags passed\")\n  }\n}\n\nfunctionPassed(testGetTags())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "45acd68a-73e5-4462-8aab-278b0b621233", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "d6d40295-5896-4053-9e87-af6866ad8252", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getTag()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "475fd491-2e8b-4251-90c8-2139053637fe", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "46c9cfff-1b7b-4408-b1e1-39bfde42cae1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetTag(): Boolean = {\n  \n  import scala.collection.mutable.ArrayBuffer\n  \n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  // Test that returns null when not present\n  try {\n    assert(getTag(\"thiswillneverbeincluded\") == null)\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"tag value for 'thiswillneverbeincluded' is not null\")\n  }\n  \n  // Test that default value is returned when not present\n  try {\n    assert(getTag(\"thiswillneverbeincluded\", \"default-test\").contentEquals(\"default-test\"))\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"tag value for 'thiswillneverbeincluded' is not the default value\")\n  }\n  \n  // Test that correct result is returned when default value is not set\n  try {\n    val orgId = getTags().collect({ case (t, v) if t.name == \"orgId\" => v }).toSeq(0)\n    assert(orgId.isInstanceOf[String])\n    assert(orgId.size > 0)\n    assert(orgId.contentEquals(getTag(\"orgId\")))\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"Unexpected tag value returned for getTag\")\n  }\n\n  // Print final info and return\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for getTag passed\")\n    true\n  } else {\n    throw new Exception(s\"$numTestsPassed of ${testsPassed.length} tests for getTag passed\")\n  }\n}\n\nfunctionPassed(testGetTag())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "31b37314-ab50-4715-9f99-1294014497d6", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2dce0ed8-18f8-48c6-91e5-72d1554d141b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `getDbrMajorAndMinorVersions()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0dcfd3e1-0f20-4a72-9089-121f1d7f54aa", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5ff74a06-4496-44da-8329-19f44163934e", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetDbrMajorAndMinorVersions(): Boolean = {\n  // We cannot rely on the assumption that all courses are\n  // running latestDbrMajor.latestDbrMinor. The best we\n  // can do here is make sure it matches the environment\n  // variable from which it came.\n  val dbrVersion = System.getenv().get(\"DATABRICKS_RUNTIME_VERSION\")\n  \n  val (major,minor) = getDbrMajorAndMinorVersions()\n  assert(dbrVersion.startsWith(f\"${major}.${minor}\"), f\"Found ${major}.${minor} for ${dbrVersion}\")\n  \n  return true\n}\n\nfunctionPassed(testGetDbrMajorAndMinorVersions())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e8359990-8376-412d-a7fc-31eafddf260f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5a367ebb-34de-44f3-8a81-1f5469891264", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `getPythonVersion()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c61710d0-e7e4-4d65-83ed-3bf23607eb59", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9af99ad5-5f4e-4873-8803-a9d8e2357823", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getUsername()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f677ae73-531f-4e91-953e-4b99b50d5d7c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4ba7b9a6-bc5a-4cdd-a2c9-1a25c4906ab1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetUsername(): Boolean = {\n  val username = getUsername()\n  assert(username.isInstanceOf[String])\n  assert(!username.contentEquals(\"\"))\n  \n  return true\n}\nfunctionPassed(testGetUsername())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5abf4635-538e-4064-85eb-424c9cb7851d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7c4d7af0-79d6-497d-97d9-2ce817ba755a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getUserhome`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ea215c4c-fbc6-499d-9bb8-13394a2fc424", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "dd184e60-c0b7-4bdf-acf9-6552ec389a7e", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetUserhome(): Boolean = {\n  val userhome = getUserhome()\n  assert(userhome.isInstanceOf[String])\n  assert(!userhome.contentEquals(\"\"))\n  assert(userhome == \"dbfs:/user/\" + getUsername())\n    \n  return true\n}\n\nfunctionPassed(testGetUserhome())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2bcf2446-beef-4170-940c-1fe8e0b71a13", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "246ea2e7-4fd0-4ef7-8b67-bc0d81f2ce63", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 16, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `assertDbrVersion`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2074a579-4b93-491d-8b32-75a10305c0df", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8c6e6c75-360c-4cf1-83b3-85daf135ea98", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 17, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testAssertDbrVersion(): Boolean = {\n  \n  val (majorVersion, minorVersion) = getDbrMajorAndMinorVersions()\n  val major = majorVersion.toInt\n  val minor = minorVersion.toInt\n\n  val goodVersions = Seq(\n    (\"SG1\", major-1, minor-1),\n    (\"SG2\", major-1, minor),\n    (\"SG3\", major, minor-1),\n    (\"SG4\", major, minor)\n  )\n  \n  for ( (name, testMajor, testMinor) <- goodVersions) {\n    println(f\"-- ${name} ${testMajor}.${testMinor}\")\n    assertDbrVersion(null, testMajor, testMinor, false)\n    println(f\"-\"*80)\n  }\n\n  val badVersions = Seq(\n    (\"SB1\", major+1, minor+1),\n    (\"SB2\", major+1, minor),\n    (\"SB3\", major, minor+1)\n  )\n\n  for ( (name, testMajor, testMinor) <- badVersions) {\n    try {\n      println(f\"-- ${name} ${testMajor}.${testMinor}\")\n      assertDbrVersion(null, testMajor, testMinor, false)\n      throw new Exception(\"Expected AssertionError\")\n    } catch {\n      case e: AssertionError => println(e)\n    }\n    println(f\"-\"*80)\n  }\n  return true\n}\nfunctionPassed(testAssertDbrVersion())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9ef9d198-21e0-41eb-a4b6-77eb99343598", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b73baa12-c88e-47a5-bf4e-813d1e3e7f07", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 18, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `assertIsMlRuntime`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f1cc92d6-3aac-462d-bd86-241b5cf31182", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "df021488-c260-4d00-81da-e95c1e39896b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 19, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// def testAssertIsMlRuntime(): Boolean = {\n    \n//   assertIsMlRuntime(\"5.5.x-ml-scala2.11\")\n//   assertIsMlRuntime(\"5.5.x-cpu-ml-scala2.11\")\n\n//   try {\n//     assertIsMlRuntime(\"5.5.x-scala2.11\")\n//     assert(false, s\"Expected to throw an IllegalArgumentException\")\n//   } catch {\n//     case _: AssertionError => ()\n//   }\n\n//   try {\n//     assertIsMlRuntime(\"5.5.xml-scala2.11\")\n//     assert(false, s\"Expected to throw an IllegalArgumentException\")\n//   } catch {\n//     case _: AssertionError => ()\n//   }\n\n//   return true\n// }\n// functionPassed(testAssertIsMlRuntime())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "fe4a7635-f48b-40a0-9cd9-c2fae171ddde", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "6428e91c-0adb-4448-a7b2-62133bfe5261", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 20, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test Legacy Functions\n\nNote: Legacy functions will not be tested. Use at your own risk.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e1d48381-a68d-4c3d-b7c6-6ec1666622d4", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ffb1d82b-6779-4787-a1bd-e709046a1811", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 21, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `createUserDatabase`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "069d6296-b515-4156-9319-3c0bc9d2dad9", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e0e75e0d-48ea-4860-9698-29616adcc1ee", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 22, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testCreateUserDatabase(): Boolean = {\n\n  val courseType = \"wa\"\n  val username = \"mickey.mouse@disney.com\"\n  val moduleName = \"Testing-Stuff 101\"\n  val lessonName = \"TS 03 - Underwater Basket Weaving\"\n  \n  // Test that correct database name is returned\n  val expectedDatabaseName = \"mickey_mouse_disney_com\" + \"_\" + \"testing_stuff_101\" + \"_\" + \"ts_03_underwater_basket_weaving\" + \"_\" + \"s\" + \"wa\"\n  \n  val databaseName = getDatabaseName(courseType, username, moduleName, lessonName)\n  assert(databaseName == expectedDatabaseName)\n  \n  val actualDatabaseName = createUserDatabase(courseType, username, moduleName, lessonName)\n  assert(actualDatabaseName == expectedDatabaseName)\n\n  // Spark 2 uses \"database\" column and Spark 3 uses \"namespace\"\n  val SPARK_SCALA_VERSION = sys.env(\"SPARK_SCALA_VERSION\")\n  val columnName = if (SPARK_SCALA_VERSION == \"2.12\") \"namespace\" else if (SPARK_SCALA_VERSION == \"2.11\") \"databaseName\" else \"unknown\"\n  \n  assert(spark.sql(s\"SHOW DATABASES LIKE '$expectedDatabaseName'\").first.getAs[String](columnName) == expectedDatabaseName)\n  assert(spark.sql(\"SELECT current_database()\").first.getAs[String](\"current_database()\") == expectedDatabaseName)\n  \n  return true\n}\nfunctionPassed(testCreateUserDatabase())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e9eaca46-0bef-463f-8ae3-fd264987bc47", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ec9b3e30-0367-4a8d-b9b0-b70d1243e508", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 23, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `getExperimentId()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6042302a-a6af-4468-b8bd-9ab3bd01f455", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "6c2e021d-39b2-4ed7-a2a2-a1560080cf59", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 24, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetExperimentId(): Boolean = {\n  \n  import scala.collection.mutable.ArrayBuffer\n\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  // Test that result is correct type\n  try {\n    assert(getExperimentId().isInstanceOf[Long])\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"result of getExperimentId is not of Long type\")\n  }\n  \n  // Note that the tags are an immutable map so we can't test other values\n  // Another option is add parameters to getExperimentId, but that could break existing uses\n  \n  // Test that result comes out as expected\n  try {\n    val notebookId = try {\n      com.databricks.logging.AttributionContext.current.tags(com.databricks.logging.TagDefinition(\"notebookId\", \"\"))\n    } catch {\n      case e: Exception => null\n    }\n    val jobId = try {\n      com.databricks.logging.AttributionContext.current.tags(com.databricks.logging.TagDefinition(\"jobId\", \"\"))\n    } catch {\n      case e: Exception => null\n    }\n    val expectedResult = if (notebookId != null){\n      notebookId.toLong\n    } else {\n      if (jobId != null) {\n        jobId.toLong\n      } else {\n        0\n      }\n    }\n    assert(expectedResult == getExperimentId())\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"unexpected result for getExperimentId\")\n  }\n  \n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for getExperimentId passed\")\n    true\n  } else {\n    throw new Exception(s\"$numTestsPassed of ${testsPassed.length} tests for getExperimentId passed\")\n  }\n}\n\nfunctionPassed(testGetExperimentId())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cd180338-9bb6-47c7-8a3f-496bfcf16f15", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "82958e7b-50ad-4b34-8063-c1aa92abf1b8", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 25, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `classroomCleanup()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d0fa5433-ad5b-4e74-8131-a3faad960838", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2f15c45d-58b7-4db8-bec1-6fa4712cc7c2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 26, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"sp\", getUsername(), getModuleName(), getLessonName(), false)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d994c97f-094e-4a0c-aedc-1c85ad311b89", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ad57ca9c-bce9-47e0-85c8-90205fee8af4", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 27, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"il\", getUsername(), getModuleName(), getLessonName(), true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "79e2f562-eefc-4ab3-bcd8-3baddda32320", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9d25bfbd-f9de-4d9d-88cb-404e656c0cd3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 28, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"sp\", getUsername(), getModuleName(), getLessonName(), false)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "33184cb1-6a19-4f7e-bfb4-7541c1db196d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "90791bbb-c76b-4bf8-a59d-92a713b676f5", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 29, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"il\", getUsername(), getModuleName(), getLessonName(), true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c61cf9fe-e58e-46a5-817f-58a0e79216aa", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "01f67289-2469-4c4d-844d-88528f5befc6", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 30, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test FILL_IN", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "49e5d5b6-d7fb-4677-a5fe-12b5e84ce6c6", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "dd00a3bf-7c0b-4f2e-83b5-43077a42d11d", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 31, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "println(FILL_IN)\nprintln(FILL_IN.VALUE)\nprintln(FILL_IN.ARRAY)\nprintln(FILL_IN.SCHEMA)\nprintln(FILL_IN.ROW)\nprintln(FILL_IN.LONG)\nprintln(FILL_IN.INT)\nprintln(FILL_IN.DATAFRAME)\nprintln(FILL_IN.DATASET)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b4c547c3-f838-4993-b69e-7a8203b0c660", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "cbc81663-29bf-43ef-9c4f-0b15b8f24b9a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 32, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `showStudentSurvey()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "af26ce74-cd12-4bbc-bc90-1dbb691ca90f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f759ac10-f83b-4393-886c-5658fcfdfef2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 33, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val html = renderStudentSurvey()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cc3b7328-b2b3-49d5-9c53-70ed7cd9245a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "57bf66ca-79a7-4d18-b9bd-1f061af58ee4", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 34, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "showStudentSurvey()\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e06ebb01-bb43-4c34-9cc2-4b1516b2bc29", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b8f29ce1-1cbd-4c3c-925d-1b3f9e6a3801", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 35, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "c1d0a325-e6b3-4492-b229-67bba776ecc4", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Class-Utility-Methods-Test", "origId": 0, "version": "NotebookV1"}