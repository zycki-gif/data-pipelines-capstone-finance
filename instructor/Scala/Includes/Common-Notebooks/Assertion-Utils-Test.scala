{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Assertion-Utils-Test\nThe purpose of this notebook is to faciliate testing of assertions.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "04d2cb4a-5d56-440c-b0f0-c9605a0efcd1", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7b69ce65-66ce-480c-93f0-8b230e6a2121", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "562db73f-ebb5-4d8d-9449-52dacd713b74", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f514b0b9-39bc-4f6a-8bd2-147bbaa29c22", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cc275e82-7d20-40f9-81db-90b1e79d86aa", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a086bc07-6d79-4dab-a31d-4fec6ad08fdd", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "18112ce3-4d74-4f87-95e8-ff0b5d840417", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "886f7ce5-f67f-4fcc-9ab4-0e09c7889f95", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# TestSuite", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "450916fd-dd77-43bf-8ed0-30f5730be785", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "01fc2e63-f8e7-4ec9-9989-a0a33f77ba1d", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "println(s\"Score:      ${TestResultsAggregator.score}\")\nprintln(s\"Max Score:  ${TestResultsAggregator.maxScore}\")\nprintln(s\"Percentage: ${TestResultsAggregator.percentage}\")\n\nprintln(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "063bdd6e-003f-4cd3-91a9-6e323a49ad2e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7cce9f85-20ff-4e77-8be9-c69768b3b344", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteA = TestSuite()\nsuiteA.test(\"ScalaTest-1\", s\"My first scala test\",  testFunction = () => true)\nsuiteA.test(\"ScalaTest-2\", s\"My second scala test\", testFunction = () => false)\nsuiteA.test(\"ScalaTest-3\", null,                    testFunction = () => true)\nsuiteA.test(\"ScalaTest-4\", s\"My fourth scala test\", testFunction = () => false)\n\nfor (testResult <- suiteA.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status}\")\n}\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${suiteA.score}\")\nprintln(s\"Max Score:  ${suiteA.maxScore}\")\nprintln(s\"Percentage: ${suiteA.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteA.score == 2, s\"A.score: ${suiteA.score}\")\nassert(suiteA.maxScore == 4, s\"A.maxScmaxScoreore: ${suiteA.maxScore}\")\nassert(suiteA.percentage == 50, s\"A.percentage: ${suiteA.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "33114ec5-280f-48cc-969d-6cd424a15f1f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4e8b7b43-b5ed-4119-b7ee-00f6f5f07757", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteB = TestSuite()\nsuiteB.test(\"ScalaTest-5\", \"My fifth scala test\",   () => true, points=3)\nsuiteB.testEquals(\"ScalaTest-6\", \"My sixth scala test\",   \"cat\", \"doc\", points=3)\nsuiteB.testEquals(\"ScalaTest-7\", \"My seventh scala test\", 99, 100-1,  points=3)\n\nsuiteB.testContains(\"List-Pass\", \"A list contains\",          Seq(\"dog\",\"bird\",\"cat\"), \"cat\",  points=3)\nsuiteB.testContains(\"List-Fail\", \"A list does not contain\",  Seq(\"dog\",\"bird\",\"cat\"), \"cow\",  points=3)\n\nsuiteB.testFloats(\"Floats-Pass\", \"Floats that match\",        1.001, 1.002, 0.01,  points=3)\nsuiteB.testFloats(\"Floats-Fail\", \"Floats that do not match\", 1.001, 1.002, 0.001, points=3)\n\nval dfA = Seq((\"Duck\", 10000), (\"Mouse\", 60000)).toDF(\"LastName\", \"MaxSalary\")\nval dfB = Seq((\"Duck\", 10000), (\"Chicken\", 60000)).toDF(\"LastName\", \"MaxSalary\")\nval dfC = Seq((\"Duck\", 10000), (\"Mouse\", 60000)).toDF(\"LastName\", \"MaxSalary\")\n\nsuiteB.testRows(\"Rows-Pass\", \"Rows that match\",        dfA.collect()(0), dfB.collect()(0) )\nsuiteB.testRows(\"Rows-Fail\", \"Rows that do not match\", dfA.collect()(1), dfB.collect()(1) )\n\nsuiteB.testDataFrames(\"DF-Pass\", \"DataFrames that match\",        dfA, dfC, true, true)\nsuiteB.testDataFrames(\"DF-Fail\", \"DataFrames that do not match\", dfA, dfB, true, true )\n\n//////////////////////////////////////////\n// Print the reulsts\nprintln(\"-\"*80)\nfor (testResult <- suiteB.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status} (${testResult.points}/${testResult.test.points})\")\n}\n\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${suiteB.score}\")\nprintln(s\"Max Score:  ${suiteB.maxScore}\")\nprintln(s\"Percentage: ${suiteB.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteB.score == 14, s\"B.score: ${suiteB.score}\")\nassert(suiteB.maxScore == 25, s\"B.maxScore: ${suiteB.maxScore}\")\nassert(suiteB.percentage == 56, s\"B.percentage: ${suiteB.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ce3586a6-9e4b-4c8a-aca9-28edd4bb2b10", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ac808d4d-8b99-4bd4-b8f2-a32dc6173b46", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteC = TestSuite()\n\nprintln(s\"Score:      ${suiteC.score}\")\nprintln(s\"Max Score:  ${suiteC.maxScore}\")\nprintln(s\"Percentage: ${suiteC.percentage}\")\n\nprintln(\"-\"*80)\n\nassert(suiteC.score == 0, s\"C.score: ${suiteC.score}\")\nassert(suiteC.maxScore == 0, s\"C.maxScore: ${suiteC.maxScore}\")\nassert(suiteC.percentage == 0, s\"C.percentage: ${suiteC.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "078aca54-7035-41fa-8b56-c56f9eb5bfac", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "356175d2-25c6-4e2e-86ea-054e84dd4011", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteA.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "921131d7-ae16-44b8-aa37-5eb25d35a19f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3afebad3-c4d9-4ee0-91fe-be0f55800958", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteB.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "dcab5cbf-9536-49b2-8f68-69269eca3148", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7f260f91-8f91-461a-b423-f0cb86e48832", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteC.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c5d7dff8-9ca5-41ee-b2d7-e35dd801b58d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5e8e25d3-aec1-4a99-addd-1860fdb62c53", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "for ( (key, testResult) <- TestResultsAggregator.testResults) {\n  println(s\"${testResult.test.id}: ${testResult.status} (${testResult.points})\")\n}\nprintln(\"-\"*80)\n\nprintln(s\"Score:      ${TestResultsAggregator.score}\")\nprintln(s\"Max Score:  ${TestResultsAggregator.maxScore}\")\nprintln(s\"Percentage: ${TestResultsAggregator.percentage}\")\n\nprintln(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "42a49e1d-0d96-42a4-8a6f-dee1e31bc4d8", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0e02cd98-8ae0-40d2-ac38-56c18ff0eb80", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "TestResultsAggregator.displayResults", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "20d8433c-afad-46ba-bada-45090adf2f63", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "50dfbe4b-333e-460b-a6a1-64f727c4f669", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert(TestResultsAggregator.score == 16, s\"TR.score: ${TestResultsAggregator.score}\")\nassert(TestResultsAggregator.maxScore == 29, s\"TR.maxScore: ${TestResultsAggregator.maxScore}\")\nassert(TestResultsAggregator.percentage == 55, s\"TR.percentage: ${TestResultsAggregator.percentage}\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "1217dce9-5bc0-4f79-b0bb-00f254af9d51", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fcb3918a-d9e7-4c2e-ac0d-0e9c54ade5f6", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val suiteX = TestSuite()\n\ntry {\n  suiteX.test(null, null, () => true)\n  throw new Exception(\"Expexted an IllegalArgumentException\")\n} catch {\n  case e:IllegalArgumentException => ()\n}\n\ntry {\n  suiteX.test(\"abc\", null, () => true)\n  suiteX.test(\"abc\", null, () => true)\n  throw new Exception(\"Expexted an IllegalArgumentException\")\n} catch {\n  case e:IllegalArgumentException => ()\n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "22a8a028-2b55-4f3e-966d-f6d92ebf3c09", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2e1a31bc-5c74-47d1-9578-69d0bac71d11", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 16, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# dbTest()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9f9b19d1-6147-42ff-9780-d8392d663dce", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a40079df-0a26-4291-b73a-68f722921e83", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 17, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "dbTest(\"ScalaTest-1\", \"cat\", \"cat\")\n\ntry {\n  dbTest(\"ScalaTest-2\", \"cat\", \"dog\")  \n} catch {\n  case _: AssertionError => ()\n}\n// dbTest(\"ScalaTest-3\", 999, 666)  ", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2a9e9640-7a57-42ac-90a0-f06ec25a971e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a83d5cae-f913-4d5a-a01e-42bd97b10b44", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 18, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareFloats\n\n```compareFloats(floatA, floatB, tolerance)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "dba75f07-8dbd-46cb-bd00-ee172079dc42", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e385682e-7bf5-446a-97df-5ba9eb625f07", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 19, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert(compareFloats(1, 1.toInt) == true)\n\nassert(compareFloats(100.001, 100.toInt) == true)\nassert(compareFloats(100.001, 100.toLong) == true)\nassert(compareFloats(100.001, 100.toFloat) == true)\nassert(compareFloats(100.001, 100.toDouble) == true)\n\nassert(compareFloats(100.toInt, 100.001) == true)\nassert(compareFloats(100.toLong, 100.001) == true)\nassert(compareFloats(100.toFloat, 100.001) == true)\nassert(compareFloats(100.toDouble, 100.001) == true)\n\nassert(compareFloats(100.001, \"blah\") == false)\nassert(compareFloats(\"blah\", 100.001) == false)\n\nassert(compareFloats(1.0, 1.0) == true)\n\nassert(compareFloats(1.0, 1.2, .0001) == false)\nassert(compareFloats(1.0, 1.02, .0001) == false)\nassert(compareFloats(1.0, 1.002, .0001) == false)\nassert(compareFloats(1.0, 1.0002, .0001) == false)\nassert(compareFloats(1.0, 1.00002, .0001) == true)\nassert(compareFloats(1.0, 1.000002, .0001) == true)\n\nassert(compareFloats(1.2, 1.0, .0001) == false)\nassert(compareFloats(1.02, 1.0, .0001) == false)\nassert(compareFloats(1.002, 1.0, .0001) == false)\nassert(compareFloats(1.0002, 1.0, .0001) == false)\nassert(compareFloats(1.00002, 1.0, .0001) == true)\nassert(compareFloats(1.000002, 1.0, .0001) == true)\n\nassert(compareFloats(1, null) == false)\nassert(compareFloats(null, 1) == false)\nassert(compareFloats(null, null) == true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6dfd26ea-cf63-4fb6-94ba-dbb8ecf8bf5c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "158d3b8e-8a03-4bbd-b562-44a17d5122cb", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 20, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareSchemas\n\n```compareSchemas(schemaA, schemaB, testColumnOrder=True, testNullable=False)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cde3b343-1da9-4d03-a251-4d3436266075", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "166d0486-eed8-4027-b8c3-9d4675fd9e46", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 21, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "import org.apache.spark.sql.types._ \nval _expectedSchema = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", DoubleType, true)\n  ))\n\nval _studentSchema1 = StructType(List(\n  StructField(\"MaxSalary\", DoubleType, true),\n  StructField(\"LastName\", StringType, true)\n  ))\n\nval _studentSchema2 = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", BooleanType, true)\n  ))\n\nval _studentSchema3 = StructType(List(\n  StructField(\"LastName\", StringType, false),\n  StructField(\"MaxSalary\", DoubleType, true)\n))\n\nval _studentSchema4 = StructType(List(\n  StructField(\"LastName\", StringType, true),\n  StructField(\"MaxSalary\", DoubleType, true),\n  StructField(\"Country\", StringType, true)\n  ))\n\nassert(compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=false, testNullable=true) == true,  \"out of order, ignore order\")\nassert(compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=true, testNullable=true) == false,  \"out of order, preserve order\")\nassert(compareSchemas(_expectedSchema, _studentSchema2, testColumnOrder=false, testNullable=true) == false, \"different types\")\n\nassert(compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=true, testNullable=true) == false,  \"check nullable\")  \nassert(compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=true, testNullable=false) == true,  \"don't check nullable\")\n\nassert(compareSchemas(_expectedSchema, _studentSchema4, testColumnOrder=true, testNullable=true) == false,  \"left side < right size\")\nassert(compareSchemas(_studentSchema4, _expectedSchema, testColumnOrder=true, testNullable=true) == false,  \"left side > right side\")\n\nassert(compareSchemas(null,            _studentSchema3, testColumnOrder=true, testNullable=true) == false, \"Null schemaA\")\nassert(compareSchemas(null,            null,            testColumnOrder=true, testNullable=true) == true,  \"Null schemaA and schemaB\")\nassert(compareSchemas(_studentSchema2, null,            testColumnOrder=true, testNullable=true) == false, \"Null schemaB\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "26e93401-9623-4e1d-934a-da6b1c402abf", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "505f56c4-da7c-47fb-a41c-055ea61ea4bd", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 22, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareRows\n\n```compareRows(rowA, rowB)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ea74cfd9-cc10-41c1-9d92-04f47e0ab260", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "537fdcec-422e-4c7f-96d8-8037413e3e10", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 23, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val bla = Row(\"Duck\", 10000.0)\nbla.schema", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "cf8a8fea-f4d7-4043-bf46-7c173e746a64", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a31520ed-8cb3-4ef4-aee6-6039691df532", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 24, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val df1 = Seq((\"Duck\", 10000.0), (\"Mouse\", 60000.0)).toDF(\"LastName\", \"MaxSalary\")\nval _rowA = df1.collect()(0)\nval _rowB = df1.collect()(1)\n\nval df2 = Seq((10000.0, \"Duck\")).toDF(\"MaxSalary\", \"LastName\")\nval _rowC = df2.collect()(0)\n\nval df3 = Seq((\"Duck\", 10000.0, \"Anaheim\")).toDF(\"LastName\", \"MaxSalary\", \"City\")\nval _rowD = df3.collect()(0)\n\n// no schema!\nval _rowE =  Row(\"Duck\", 10000.0)\nval _rowF =  Row(\"Mouse\", 60000.0)\n\nassert(compareRows(_rowA, _rowB) == false)                   // different schemas\nassert(compareRows(_rowA, _rowA) == true)                    // compare to self\nassert(compareRows(_rowA, _rowC) == true)                    // order reversed\nassert(compareRows(null, _rowA) == false, \"null _rowA\")      // Null rowA\nassert(compareRows(null, null) == true, \"null _rowA, rowB\")  // Null rowA and rowB\nassert(compareRows(_rowA, null) == false, \"null _rowB\")      // Null rowB\nassert(compareRows(_rowA, _rowD) == false)                   // _rowA smaller than _rowD\nassert(compareRows(_rowD, _rowA) == false)                   // _rowD smaller than _rowA \nassert(compareRows(_rowE, _rowF) == false)                   // no schemas, different\nassert(compareRows(_rowE, _rowE) == true)                    // no schemas, same\nassert(compareRows(_rowE, _rowA) == true)                    // no schemas / schema, same content\nassert(compareRows(_rowE, _rowB) == false)                    // no schemas / schema, different content\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0f600e69-d562-48a5-b66b-45e815ee056a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "494dd78f-5964-4ed9-ae84-9c48b43a6984", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 25, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "1c8494ae-32fa-4183-93d1-7efbc67be3d8", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Assertion-Utils-Test", "origId": 0, "version": "NotebookV1"}