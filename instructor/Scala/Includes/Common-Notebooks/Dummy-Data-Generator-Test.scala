{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Dummy-Data-Generator-Test\nThe purpose of this notebook is to faciliate testing of the dummy data generator.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "29de099b-b9c8-409a-a57f-c3e9eba7288f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3204f9ca-84be-4c75-9212-9595e80c4317", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "28dbb45b-8bc9-4d25-8048-71b882b74e9b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5ec810cd-9b0e-4e29-989f-416f93a7bba7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2c2a84ba-4e1d-4d30-922f-595f2369d4f0", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5910b379-d759-4db7-9a1c-2d6ca27b5cca", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "326d7bfa-a56e-4ce9-a705-193e8958b835", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "54540029-e48f-4e0f-be9c-58ef750ae78a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val courseType = \"test\"\nval moduleName = getModuleName()\nval lessonName = getLessonName()\nval username = getUsername()\nval userhome = getUserhome()\nval workingDir = getWorkingDir(courseType)\nval databaseName = createUserDatabase(courseType, username, moduleName, lessonName)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "97d167ea-f89e-4889-96e4-f61432b9b1b6", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "311dd431-21bf-4061-b9e3-5d3e6d234982", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "13e7dde4-2e3b-4a3c-9224-3ed570e618d3", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ec70e027-d15d-447f-ae18-03f08acd336b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// Initialize the username\nspark.conf.set(\"com.databricks.training.username\", \"test\")\nspark.conf.set(\"com.databricks.training.userhome\", \"dbfs:/user/test\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "105c77ec-ca2b-49c9-875a-9c5fa14853f7", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b51f72e4-8f38-4b89-8389-3287ec7301e0", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// name: String = \"Name\", \n// id: String = \"ID\", \n// password: String = \"Password\", \n// amount: String = \"Amount\", \n// percent: String = \"Percent\", \n// probability: String = \"Probability\", \n// yesNo: String = \"YesNo\", \n// UTCTime: String = \"UTCTime\"\nimport org.apache.spark.sql.types.{StringType, DoubleType, IntegerType, BooleanType, LongType}\n\n// default rows\nval testDefaultRowsDF = new DummyData(\"test_1_scala\").toDF\nassert(testDefaultRowsDF.count == 300)\n\n// custom rows\nval testCustomRowsDF = new DummyData(\"test_2_scala\", numRows=50).toDF\nassert(testCustomRowsDF.count == 50)\n\n// custom field names\nval testCustomField1DF = new DummyData(\"test_3_scala\").addNames(\"EmployeeName\").toDF\nval fields1 = testCustomField1DF.schema.names \nassert(fields1.contains(\"EmployeeName\"))\nassert(testCustomField1DF.schema.fields(1).dataType == StringType)\n\nval testCustomField2DF = new DummyData(\"test_4_scala\").renameId(\"EmployeeID\").toDF\nval fields2 = testCustomField2DF.schema.names \nassert(fields2.contains(\"EmployeeID\"))\nassert(testCustomField2DF.schema.fields(0).dataType == LongType)\n\nval testCustomField3DF = new DummyData(\"test_5_scala\").addPasswords(\"Yak\").toDF\nval fields3 = testCustomField3DF.schema.names\nassert(testCustomField3DF.schema.fields(1).dataType == StringType)\nassert(fields3.contains(\"Yak\"))\n\nval testCustomField4DF = new DummyData(\"test_6_scala\").addDoubles(\"Salary\").toDF\nval fields4 = testCustomField4DF.schema.names \nassert(testCustomField4DF.schema.fields(1).dataType == DoubleType)\nassert(fields4.contains(\"Salary\"))\n\nval testCustomField5DF = new DummyData(\"test_7_scala\").addIntegers(\"ZeroTo100\").toDF\nval fields5 = testCustomField5DF.schema.names \nassert(testCustomField5DF.schema.fields(1).dataType == IntegerType)\nassert(fields5.contains(\"ZeroTo100\"))\n\nval testCustomField6DF = new DummyData(\"test_8_scala\").addProportions(\"Prob\").toDF\nval fields6 = testCustomField6DF.schema.names \nassert(testCustomField6DF.schema.fields(1).dataType == DoubleType)\nassert(fields6.contains(\"Prob\")) \n\nval testCustomField7DF = new DummyData(\"test_9_scala\").addBooleans(\"isOK\").toDF\nval fields7 = testCustomField7DF.schema.names \nassert(testCustomField7DF.schema.fields(1).dataType == BooleanType)\nassert(fields7.contains(\"isOK\"))\n\nval testCustomField8DF = new DummyData(\"test_10_scala\").addTimestamps(\"Timestamp\").toDF\nval fields8 = testCustomField8DF.schema.names \nassert(testCustomField8DF.schema.fields(1).dataType == IntegerType)\nassert(fields8.contains(\"Timestamp\"))\n\n// all custome field names, custom rows\nval testCustomFieldsDF = new DummyData(\"test_11_scala\", numRows=50)\n    .addNames(\"EmployeeName\")\n    .renameId(\"EmployeeID\")\n    .addPasswords(\"Yak\")\n    .addDoubles(\"Salary\")\n    .addIntegers(\"ZeroTo100\")\n    .addProportions(\"Prob\")\n    .addBooleans(\"isOK\")\n    .addTimestamps(\"Timestamp\")\n    .toDF\nval fields = testCustomFieldsDF.schema.names\nassert(fields.deep == Array(\"EmployeeID\", \"EmployeeName\", \"Yak\", \"Salary\", \"ZeroTo100\", \"Prob\", \"isOK\", \"Timestamp\").deep)\nassert(testCustomFieldsDF.count == 50)\nassert(testCustomFieldsDF.schema.fields(0).dataType == LongType)\nassert(testCustomFieldsDF.schema.fields(1).dataType == StringType)\nassert(testCustomFieldsDF.schema.fields(2).dataType == StringType)\nassert(testCustomFieldsDF.schema.fields(3).dataType == DoubleType)\nassert(testCustomFieldsDF.schema.fields(4).dataType == IntegerType)\nassert(testCustomFieldsDF.schema.fields(5).dataType == DoubleType)\nassert(testCustomFieldsDF.schema.fields(6).dataType == BooleanType)\nassert(testCustomFieldsDF.schema.fields(7).dataType == IntegerType)\n\n// needs to be done: restructure testing format to match class-utility-methods\n// needs to be done: add unit testing for the DummyData.add*() methods and their parameters\n// needs to be done: add value testing", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f6e55ca4-bcfb-4e32-81b1-8e1b9e715c64", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "462bf46d-e7a2-4525-aec5-61b2818aaf6a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.sql(s\"DROP DATABASE IF EXISTS $databaseName CASCADE\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d3d9152c-074b-4df9-a704-96a79387a6fd", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4e018750-0649-49ac-80f0-8bb913a18c5d", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2d44d08e-c955-4281-81c9-ec55442e48ea", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "631ccf37-c879-4901-8f5d-a984e8585361", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "8285e7b2-6868-4447-be60-7a91ad6f0bd2", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Dummy-Data-Generator-Test", "origId": 0, "version": "NotebookV1"}