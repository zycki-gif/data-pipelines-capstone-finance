{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Class-Utility-Methods-Test\nThe purpose of this notebook is to faciliate testing of courseware-specific utility methos.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0565728a-4c49-43c7-b2fa-9f4b40bd4926", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c8e3f601-3fff-4d65-a3c6-b551953b4405", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2aefa230-4b92-4c53-aca4-d3c824986dc2", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "562eae05-72ba-471e-92da-8356530e2112", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\na lot of these tests evolve around the current DBR version.\n\nIt shall be assumed that the cluster is configured properly and that these tests are updated with each publishing of courseware against a new DBR", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ca50ee01-ad98-4e4a-be81-378fc1e837bd", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "d40abaad-c1f7-4702-86df-d4b7677ca9d1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "03ced06a-6a9f-41c7-9ae8-cb6985be0a9b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0eda225a-ee8b-4027-a3ba-d2d306eeba27", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def functionPassed(result: Boolean) = {\n  if (!result) {\n    assert(false, \"Test failed\")\n  } \n}", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e0caed79-7e35-4103-b377-0ab6d6ff2458", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "6c9637a7-bed4-4d9d-a9c2-dec0074c3120", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getTags`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e97e031a-0db8-4d7a-9817-afd76de28bd7", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b551649f-a562-42de-a799-3e74f14339dc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetTags(): Boolean = {\n  \n  val testTags = getTags()\n  \n  import scala.collection.mutable.ArrayBuffer\n\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  // Test that tags result is correct type\n  try {\n    assert(testTags.isInstanceOf[Map[com.databricks.logging.TagDefinition,String]])\n    passedTest(true)\n  } catch {\n    case a: AssertionError => {\n      passedTest(false, \"tags is not an instance of Map[com.databricks.logging.TagDefinition,String]\")\n    }\n    case _: Exception => {\n      passedTest(false, \"non-descript error for tags being an instance of Map[com.databricks.logging.TagDefinition,String]\")\n    }\n  }\n\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for getTags passed\")\n    true\n  } else {\n    throw new Exception(s\"$numTestsPassed of ${testsPassed.length} tests for getTags passed\")\n  }\n}\n\nfunctionPassed(testGetTags())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6ce10fe1-a149-4dbe-beda-95d123bb30ee", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b2b46c13-c7ab-439c-a762-a19c09fd8294", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getTag()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "7eed5802-ce6c-4624-b8f1-8faa99a4c21d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "cea354cc-2148-4da6-9694-d0aa87ef8ae3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetTag(): Boolean = {\n  \n  import scala.collection.mutable.ArrayBuffer\n  \n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  // Test that returns null when not present\n  try {\n    assert(getTag(\"thiswillneverbeincluded\") == null)\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"tag value for 'thiswillneverbeincluded' is not null\")\n  }\n  \n  // Test that default value is returned when not present\n  try {\n    assert(getTag(\"thiswillneverbeincluded\", \"default-test\").contentEquals(\"default-test\"))\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"tag value for 'thiswillneverbeincluded' is not the default value\")\n  }\n  \n  // Test that correct result is returned when default value is not set\n  try {\n    val orgId = getTags().collect({ case (t, v) if t.name == \"orgId\" => v }).toSeq(0)\n    assert(orgId.isInstanceOf[String])\n    assert(orgId.size > 0)\n    assert(orgId.contentEquals(getTag(\"orgId\")))\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"Unexpected tag value returned for getTag\")\n  }\n\n  // Print final info and return\n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for getTag passed\")\n    true\n  } else {\n    throw new Exception(s\"$numTestsPassed of ${testsPassed.length} tests for getTag passed\")\n  }\n}\n\nfunctionPassed(testGetTag())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "77103acb-6bb5-47d0-8047-adc891c5f9bf", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c1b0d281-993d-4522-b3fc-88f2e24d1fbc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `getDbrMajorAndMinorVersions()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "56590640-9c68-430a-88c0-4a0015188f17", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "aca1855d-6d26-4a69-b366-333b09b55e5d", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetDbrMajorAndMinorVersions(): Boolean = {\n  // We cannot rely on the assumption that all courses are\n  // running latestDbrMajor.latestDbrMinor. The best we\n  // can do here is make sure it matches the environment\n  // variable from which it came.\n  val dbrVersion = System.getenv().get(\"DATABRICKS_RUNTIME_VERSION\")\n  \n  val (major,minor) = getDbrMajorAndMinorVersions()\n  assert(dbrVersion.startsWith(f\"${major}.${minor}\"), f\"Found ${major}.${minor} for ${dbrVersion}\")\n  \n  return true\n}\n\nfunctionPassed(testGetDbrMajorAndMinorVersions())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "725cc00a-b2cd-45d9-b4c9-4a0ce7fb8431", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "22990390-5d50-414d-9176-338785774ac7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `getPythonVersion()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ab49b6f7-45e3-41fd-96bc-3c51e4c31a44", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0058b7ec-0ceb-4d11-9522-c68e317d5117", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getUsername()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f7f78242-9068-44f2-8dab-c97fabc33d85", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7cd2c99a-fc32-487d-bd73-864ce6e7bceb", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetUsername(): Boolean = {\n  val username = getUsername()\n  assert(username.isInstanceOf[String])\n  assert(!username.contentEquals(\"\"))\n  \n  return true\n}\nfunctionPassed(testGetUsername())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "50f9410a-0c8e-4df0-aa39-1cee0c65794a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "848e85cc-74aa-421e-a7ff-30d6cfdb0b18", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `getUserhome`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b351ad3d-1284-4278-a612-8742ec7a5095", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4316b2f9-591a-4d1a-b54f-96ef35d1f682", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetUserhome(): Boolean = {\n  val userhome = getUserhome()\n  assert(userhome.isInstanceOf[String])\n  assert(!userhome.contentEquals(\"\"))\n  assert(userhome == \"dbfs:/user/\" + getUsername())\n    \n  return true\n}\n\nfunctionPassed(testGetUserhome())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "65539b7b-0327-41e3-ba18-6b8404abed6e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b48fe011-68da-4b0d-be82-5a2932bc9ae4", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 16, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `assertDbrVersion`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9989582e-5cb5-42be-bb41-faf5572a3d69", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b4c41065-6b59-41b6-a7ee-810866008e27", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 17, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testAssertDbrVersion(): Boolean = {\n  \n  val (majorVersion, minorVersion) = getDbrMajorAndMinorVersions()\n  val major = majorVersion.toInt\n  val minor = minorVersion.toInt\n\n  val goodVersions = Seq(\n    (\"SG1\", major-1, minor-1),\n    (\"SG2\", major-1, minor),\n    (\"SG3\", major, minor-1),\n    (\"SG4\", major, minor)\n  )\n  \n  for ( (name, testMajor, testMinor) <- goodVersions) {\n    println(f\"-- ${name} ${testMajor}.${testMinor}\")\n    assertDbrVersion(null, testMajor, testMinor, false)\n    println(f\"-\"*80)\n  }\n\n  val badVersions = Seq(\n    (\"SB1\", major+1, minor+1),\n    (\"SB2\", major+1, minor),\n    (\"SB3\", major, minor+1)\n  )\n\n  for ( (name, testMajor, testMinor) <- badVersions) {\n    try {\n      println(f\"-- ${name} ${testMajor}.${testMinor}\")\n      assertDbrVersion(null, testMajor, testMinor, false)\n      throw new Exception(\"Expected AssertionError\")\n    } catch {\n      case e: AssertionError => println(e)\n    }\n    println(f\"-\"*80)\n  }\n  return true\n}\nfunctionPassed(testAssertDbrVersion())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a87f84ed-76ca-4ff8-acc2-f15f708e6c23", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ee515a89-5ccf-4255-b235-b86da7c347cb", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 18, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `assertIsMlRuntime`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9eb9234c-6f11-40f4-84fb-f9a117f4c040", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "23799a0d-0c43-497e-8c95-fdaf33261b22", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 19, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "// def testAssertIsMlRuntime(): Boolean = {\n    \n//   assertIsMlRuntime(\"5.5.x-ml-scala2.11\")\n//   assertIsMlRuntime(\"5.5.x-cpu-ml-scala2.11\")\n\n//   try {\n//     assertIsMlRuntime(\"5.5.x-scala2.11\")\n//     assert(false, s\"Expected to throw an IllegalArgumentException\")\n//   } catch {\n//     case _: AssertionError => ()\n//   }\n\n//   try {\n//     assertIsMlRuntime(\"5.5.xml-scala2.11\")\n//     assert(false, s\"Expected to throw an IllegalArgumentException\")\n//   } catch {\n//     case _: AssertionError => ()\n//   }\n\n//   return true\n// }\n// functionPassed(testAssertIsMlRuntime())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "b9733223-54da-492d-88fe-7e9c8add0c8e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "d2b453bb-07a2-4440-8d5a-288ef7d686c0", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 20, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test Legacy Functions\n\nNote: Legacy functions will not be tested. Use at your own risk.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "54aadbee-aae6-4073-a83f-5e24189465f3", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e134e072-ad00-4b70-b2ae-cd6d1ae0eb92", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 21, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n\n## Test `createUserDatabase`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "88ce0b2c-2202-49c4-acf2-ea0170398847", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3f1aec80-0f80-4ec4-a375-672e4b639dc0", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 22, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testCreateUserDatabase(): Boolean = {\n\n  val courseType = \"wa\"\n  val username = \"mickey.mouse@disney.com\"\n  val moduleName = \"Testing-Stuff 101\"\n  val lessonName = \"TS 03 - Underwater Basket Weaving\"\n  \n  // Test that correct database name is returned\n  val expectedDatabaseName = \"mickey_mouse_disney_com\" + \"_\" + \"testing_stuff_101\" + \"_\" + \"ts_03_underwater_basket_weaving\" + \"_\" + \"s\" + \"wa\"\n  \n  val databaseName = getDatabaseName(courseType, username, moduleName, lessonName)\n  assert(databaseName == expectedDatabaseName)\n  \n  val actualDatabaseName = createUserDatabase(courseType, username, moduleName, lessonName)\n  assert(actualDatabaseName == expectedDatabaseName)\n\n  // Spark 2 uses \"database\" column and Spark 3 uses \"namespace\"\n  val SPARK_SCALA_VERSION = sys.env(\"SPARK_SCALA_VERSION\")\n  val columnName = if (SPARK_SCALA_VERSION == \"2.12\") \"namespace\" else if (SPARK_SCALA_VERSION == \"2.11\") \"databaseName\" else \"unknown\"\n  \n  assert(spark.sql(s\"SHOW DATABASES LIKE '$expectedDatabaseName'\").first.getAs[String](columnName) == expectedDatabaseName)\n  assert(spark.sql(\"SELECT current_database()\").first.getAs[String](\"current_database()\") == expectedDatabaseName)\n  \n  return true\n}\nfunctionPassed(testCreateUserDatabase())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "fbebdfaa-9694-49de-857b-bd2751269172", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "5069bdee-1a5d-4b68-9911-655643260d9f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 23, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `getExperimentId()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "08b44fec-df9c-4d87-8d5c-8b6fd857b254", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "100a6de6-2ed5-49c0-8eb8-2b69fba767fc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 24, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "def testGetExperimentId(): Boolean = {\n  \n  import scala.collection.mutable.ArrayBuffer\n\n  val testsPassed = ArrayBuffer.empty[Boolean]\n  \n  def passedTest(result: Boolean, message: String = null) = {\n    if (result) {\n      testsPassed += true\n    } else {\n      testsPassed += false\n      println(s\"Failed Test: $message\")\n    } \n  }\n  \n  // Test that result is correct type\n  try {\n    assert(getExperimentId().isInstanceOf[Long])\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"result of getExperimentId is not of Long type\")\n  }\n  \n  // Note that the tags are an immutable map so we can't test other values\n  // Another option is add parameters to getExperimentId, but that could break existing uses\n  \n  // Test that result comes out as expected\n  try {\n    val notebookId = try {\n      com.databricks.logging.AttributionContext.current.tags(com.databricks.logging.TagDefinition(\"notebookId\", \"\"))\n    } catch {\n      case e: Exception => null\n    }\n    val jobId = try {\n      com.databricks.logging.AttributionContext.current.tags(com.databricks.logging.TagDefinition(\"jobId\", \"\"))\n    } catch {\n      case e: Exception => null\n    }\n    val expectedResult = if (notebookId != null){\n      notebookId.toLong\n    } else {\n      if (jobId != null) {\n        jobId.toLong\n      } else {\n        0\n      }\n    }\n    assert(expectedResult == getExperimentId())\n    passedTest(true)\n  } catch {\n    case e: Exception => passedTest(false, \"unexpected result for getExperimentId\")\n  }\n  \n  val numTestsPassed = testsPassed.groupBy(identity).mapValues(_.size)(true)\n  if (numTestsPassed == testsPassed.length) {\n    println(s\"All $numTestsPassed tests for getExperimentId passed\")\n    true\n  } else {\n    throw new Exception(s\"$numTestsPassed of ${testsPassed.length} tests for getExperimentId passed\")\n  }\n}\n\nfunctionPassed(testGetExperimentId())", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "7f15c84d-75d0-41a0-abff-8016e5201e9e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "303ba751-cab3-428e-a245-a5395219b553", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 25, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `classroomCleanup()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "288f61b2-80ee-4ed2-be75-85d1b102b613", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4ef647a9-ff5f-4476-89f8-b51296a45ca9", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 26, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"sp\", getUsername(), getModuleName(), getLessonName(), false)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e8fde604-be62-487a-a9a0-c6304db6217a", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b40d295f-30c2-4ddd-9375-c4d66e457c51", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 27, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"il\", getUsername(), getModuleName(), getLessonName(), true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "4dbc41d7-747b-4f84-93cd-eff49e8d2108", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0de80df5-20bc-4a2f-a88d-3c343b957f34", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 28, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"sp\", getUsername(), getModuleName(), getLessonName(), false)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d6c2f7ef-9082-45a4-894c-078c488c3e8d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e61135b3-a7eb-4051-814f-6d46aa493a5b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 29, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, \"il\", getUsername(), getModuleName(), getLessonName(), true)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a8c86980-ab6f-4d95-b6ea-e6fca3ebe115", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fa548e97-d73e-407c-9072-329623ae23b3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 30, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test FILL_IN", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ebcaa145-94db-444f-a199-6b9e08fb4cab", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e64f2b6f-11aa-480f-8876-c8aed83b88aa", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 31, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "println(FILL_IN)\nprintln(FILL_IN.VALUE)\nprintln(FILL_IN.ARRAY)\nprintln(FILL_IN.SCHEMA)\nprintln(FILL_IN.ROW)\nprintln(FILL_IN.LONG)\nprintln(FILL_IN.INT)\nprintln(FILL_IN.DATAFRAME)\nprintln(FILL_IN.DATASET)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "01f611a4-b101-49d7-ae16-309a1514cf62", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4e2d3576-765e-42f2-9513-130db00e5384", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 32, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Test `showStudentSurvey()`", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e03c1c2a-4025-4955-9bac-6a99cf266f5c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "1f9c0b0a-7364-4c85-a4fb-654942ef40b3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 33, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "val html = renderStudentSurvey()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "fb9504be-8105-4f1d-a3e2-bfe2ea9e517f", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "62bd8479-d242-4284-939f-cec9c81b6dd9", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 34, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "showStudentSurvey()\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "001fc79d-e234-49fb-9478-79dc6cc5a54c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "751561f4-6a99-44bc-992e-15f3a53d8bf0", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 35, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "58d50164-f605-4648-998f-5b0f1a6fa129", "iPythonMetadata": null, "inputWidgets": {}, "language": "scala", "name": "Class-Utility-Methods-Test", "origId": 0, "version": "NotebookV1"}