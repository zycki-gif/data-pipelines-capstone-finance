{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Assertion-Utils-Test\nThe purpose of this notebook is to faciliate testing of assertions.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "59b9c738-f2e4-4e08-8b88-9a233fb04e9b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "efb76606-2ac4-4139-9cc2-5698ef5e6d7f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0fdc6017-7750-48eb-8d25-5154b3a1b0f3", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "995fac4d-e308-43fd-9653-19ca5a7046fc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "2f7b0a8a-2c60-40d0-9cd6-f19c1106e616", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9515c446-dfdc-4dc8-916e-85f37471f81b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c3ec47d4-2c23-459d-b788-bc1bd204ff7d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "57efbe9e-c57f-4fe7-a424-5374118dfdd8", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# TestSuite", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "06d717fd-175b-4ace-828b-25c278936e20", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "bd04aac0-c275-424b-bc65-e5760242bf21", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "print(f\"Score:      {TestResultsAggregator.score}\")\nprint(f\"Max Score:  {TestResultsAggregator.maxScore}\")\nprint(f\"Percentage: {TestResultsAggregator.percentage}\")\n\nprint(\"-\"*80)\n\n# Once accessed, it must be reset\nTestResultsAggregator = __TestResultsAggregator()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "1c9ba7a4-52b1-4da7-a0cd-46b8a6e0cebb", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "dd90e51f-ba89-48ad-9e13-ddec2db830b8", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteA = TestSuite()\nsuiteA.test(\"PythonTest-1\", f\"My first python test\",  lambda: True)\nsuiteA.test(\"PythonTest-2\", f\"My second python test\", lambda: False)\nsuiteA.test(\"PythonTest-3\", None,                     lambda: True)\nsuiteA.test(\"PythonTest-4\", f\"My fourth python test\", lambda: False)\n\nfor testResult in list(suiteA.testResults):\n  print(f\"{testResult.test.id}: {testResult.status}\")\n\nprint(\"-\"*80)\n\nprint(f\"Score:      {suiteA.score}\")\nprint(f\"Max Score:  {suiteA.maxScore}\")\nprint(f\"Percentage: {suiteA.percentage}\")\n\nprint(\"-\"*80)\n\nassert suiteA.score == 2, f\"A.score: {suiteA.score}\"\nassert suiteA.maxScore == 4, f\"A.maxScmaxScoreore: {suiteA.maxScore}\"\nassert suiteA.percentage == 50, f\"A.percentage: {suiteA.percentage}\"", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "45b09b53-2e2f-47b9-b041-4f544b996396", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fc380a74-723d-48bf-b48d-5b3f12e0d347", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteB = TestSuite()\nsuiteB.test(\"PythonTest-5\", \"My fifth python test\",   lambda: True,  points=3)\nsuiteB.testEquals(\"PythonTest-6\", \"My sixth scala test\", \"cat\", \"doc\", points=3)\nsuiteB.testEquals(\"PythonTest-7\", \"My seventh scala test\", 99, 100-1,  points=3)\n\nsuiteB.testContains(\"List-Pass\", \"A list contains\",          [\"dog\",\"bird\",\"cat\"], \"cat\", points=3)\nsuiteB.testContains(\"List-Fail\", \"A list does not contain\",  [\"dog\",\"bird\",\"cat\"], \"cow\", points=3)\n\nsuiteB.testFloats(\"Floats-Pass\", \"Floats that match\",        1.001, 1.002, 0.01,  points=3)\nsuiteB.testFloats(\"Floats-Fail\", \"Floats that do not match\", 1.001, 1.002, 0.001, points=3)\n\nlistA = [(\"Duck\", 10000), (\"Mouse\", 60000)]\ndfA = spark.createDataFrame(listA)\n\nlistB = [(\"Duck\", 10000), (\"Chicken\", 60000)]\ndfB = spark.createDataFrame(listB)\n\nlistC = [(\"Duck\", 10000), (\"Mouse\", 60000)]\ndfC = spark.createDataFrame(listC)\n\nsuiteB.testRows(\"Rows-Pass\", \"Rows that match\",        dfA.collect()[0], dfB.collect()[0] )\nsuiteB.testRows(\"Rows-Fail\", \"Rows that do not match\", dfA.collect()[1], dfB.collect()[1] )\n\nsuiteB.testDataFrames(\"DF-Pass\", \"DataFrames that match\",        dfA, dfC, True, True)\nsuiteB.testDataFrames(\"DF-Fail\", \"DataFrames that do not match\", dfA, dfB, True, True)\n\n##########################################\n# Print the results\nfor testResult in list(suiteB.testResults):\n  print(f\"{testResult.test.id}: {testResult.status} ({testResult.points}/{testResult.test.points}): {testResult.exception}\")\n\nprint(\"-\"*80)\n\nprint(f\"Score:      {suiteB.score}\")\nprint(f\"Max Score:  {suiteB.maxScore}\")\nprint(f\"Percentage: {suiteB.percentage}\")\n\nprint(\"-\"*80)\n\nassert suiteB.score == 14, f\"B.score: {suiteB.score}\"\nassert suiteB.maxScore == 25, f\"B.maxScore: {suiteB.maxScore}\"\nassert suiteB.percentage == 56, f\"B.percentage: {suiteB.percentage}\"", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "812ccaf8-6f72-42fe-9a14-845aa6368e80", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "34df7484-11d7-4460-825b-222366788a13", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteC = TestSuite()\n\nprint(f\"Score:      {suiteC.score}\")\nprint(f\"Max Score:  {suiteC.maxScore}\")\nprint(f\"Percentage: {suiteC.percentage}\")\n\nprint(\"-\"*80)\n\nassert suiteC.score == 0, f\"C.score: {suiteC.score}\"\nassert suiteC.maxScore == 0, f\"C.maxScore: {suiteC.maxScore}\"\nassert suiteC.percentage == 0, f\"C.percentage: {suiteC.percentage}\"", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d8301d82-3907-4e04-9fd4-5fb2e51a488c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "709d418d-237e-4b9c-a401-f9ddf9c532d7", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteA.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "a10e57e4-5626-4a52-a03b-a30f7e084f41", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "3b5bce97-9113-4140-ba45-064daa04c20a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteB.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9ffa9b82-f335-4b18-bc7b-437df96f2d81", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7510d017-e729-4fb6-aabd-5b6094f5f27b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 11, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteC.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "3497dff8-4a7d-466e-be8e-fda18803250c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "bb94d8b4-6c1c-46b2-bd5b-ff95d8ada70b", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 12, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "for key in TestResultsAggregator.testResults:\n  testResult = TestResultsAggregator.testResults[key]\n  print(f\"\"\"{testResult.test.id}: {testResult.status} ({testResult.points})\"\"\")\n\nprint(\"-\"*80)\n\nprint(f\"Score:      {TestResultsAggregator.score}\")\nprint(f\"Max Score:  {TestResultsAggregator.maxScore}\")\nprint(f\"Percentage: {TestResultsAggregator.percentage}\")\n\nprint(\"-\"*80)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "eae795a1-2e12-46a8-b5da-130dcad030c4", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "57557716-1019-4805-8d8c-5f3b9f7ce851", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 13, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "TestResultsAggregator.displayResults()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "8ac3862b-26f3-4208-9363-9aee84482399", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "347f382e-d443-4a0c-90cc-40ba6d6f2215", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 14, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert TestResultsAggregator.score == 16, f\"TR.score: {TestResultsAggregator.score}\"\nassert TestResultsAggregator.maxScore == 29, f\"TR.maxScore: {TestResultsAggregator.maxScore}\"\nassert TestResultsAggregator.percentage == 55, f\"TR.percentage: {TestResultsAggregator.percentage}\"", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "e024bfa8-37f5-47af-acdd-d5969424488d", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9f09d8d6-f488-4942-b2e1-e3be6b202cc3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 15, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "suiteX = TestSuite()\n\ntry:\n  suiteX.test(None, None, lambda:True)\n  raise Exception(\"Expexted a value error\")\nexcept ValueError:\n  pass\n\ntry:\n  suiteX.test(\"abc\", None, lambda:True)\n  suiteX.test(\"abc\", None, lambda:True)\n  raise Exception(\"Expected a value error\")\nexcept ValueError:\n  pass", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "17921cb4-e54a-48dc-be7e-d3d6b18dfefd", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ee1240da-1c60-4d35-9267-5c7be41aaa50", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 16, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n# dbTest()", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "26387725-0ee2-488a-a7b2-5f605bec2ece", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "4c0afea5-bf47-4d54-a9ae-e4dea1d158f1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 17, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "dbTest(\"PythonTest-1\", \"cat\", \"cat\")\n\ntry:\n  dbTest(\"PythonTest-2\", \"cat\", \"dog\")\nexcept AssertionError:\n  pass\n\n# dbTest(\"PythonTest-3\", 999, 666)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c5e47883-8581-4811-9c18-ad3d3b868467", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fa922ebb-579e-401e-8cb5-c23c22918028", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 18, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareFloats\n\n```compareFloats(floatA, floatB, tolerance)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "c3b55cb0-55f8-4303-ad30-1deadfe48662", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "c72aeb8b-da06-4104-a6dc-16158e045948", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 19, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assert compareFloats(1, 1) == True\n\n# No long or double equivilent to Scala\nassert compareFloats(100.001, int(100)) == True\nassert compareFloats(100.001, float(100)) == True\n\nassert compareFloats(int(100), 100.001) == True\nassert compareFloats(float(100), 100.001) == True\n\nassert compareFloats(100.001, \"blah\") == False\nassert compareFloats(\"blah\", 100.001) == False\n\nassert compareFloats(1.0, 1.0) == True\n\nassert compareFloats(1.0, 1.2, .0001) == False\nassert compareFloats(1.0, 1.02, .0001) == False\nassert compareFloats(1.0, 1.002, .0001) == False\nassert compareFloats(1.0, 1.0002, .0001) == False\nassert compareFloats(1.0, 1.00002, .0001) == True\nassert compareFloats(1.0, 1.000002, .0001) == True\n\nassert compareFloats(1.2, 1.0, .0001) == False\nassert compareFloats(1.02, 1.0, .0001) == False\nassert compareFloats(1.002, 1.0, .0001) == False\nassert compareFloats(1.0002, 1.0, .0001) == False\nassert compareFloats(1.00002, 1.0, .0001) == True\nassert compareFloats(1.000002, 1.0, .0001) == True\n\nassert compareFloats(1, None) == False\nassert compareFloats(None, 1) == False\nassert compareFloats(None, None) == True", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "acbd799b-f0ef-4812-91da-1d774e8386b8", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0c573f46-7536-4a5d-ad12-2caab636fe31", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 20, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareSchemas\n\n```compareSchemas(schemaA, schemaB, testColumnOrder=True, testNullable=False)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "fa2780fe-e823-412b-8145-84a748965559", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0c812db6-3e4b-4cab-b33b-97517513fda3", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 21, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "from pyspark.sql.types import *\n_expectedSchema = StructType([\n  StructField(\"LastName\", StringType(), True),\n  StructField(\"MaxSalary\", DoubleType(), True)\n])\n\n_studentSchema1 = StructType([\n  StructField(\"MaxSalary\", DoubleType(), True),\n  StructField(\"LastName\", StringType(), True)\n])\n\n_studentSchema2 = StructType([\n  StructField(\"LastName\", StringType(), True),\n  StructField(\"MaxSalary\", BooleanType(), True)\n])\n\n_studentSchema3 = StructType([\n  StructField(\"LastName\", StringType(), False),\n  StructField(\"MaxSalary\", DoubleType(), True)\n])\n\n_studentSchema4 = StructType([\n  StructField(\"LastName\", StringType(), True),\n  StructField(\"MaxSalary\", DoubleType(), True),\n  StructField(\"Country\", StringType(), True)\n])\n\nassert compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=False, testNullable=True) == True, \"out of order, ignore order\"\nassert compareSchemas(_expectedSchema, _studentSchema1, testColumnOrder=True, testNullable=True) == False, \"out of order, preserve order\"\n\nassert compareSchemas(_expectedSchema, _studentSchema2, testColumnOrder=True, testNullable=True) == False, \"different types\"\n\nassert compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=True, testNullable=True) == False, \"check nullable\"\nassert compareSchemas(_expectedSchema, _studentSchema3, testColumnOrder=True, testNullable=False) == True, \"don't check nullable\"\n\nassert compareSchemas(_expectedSchema, _studentSchema4, testColumnOrder=True, testNullable=True) == False, \"left side < right size\"\nassert compareSchemas(_studentSchema4, _expectedSchema, testColumnOrder=True, testNullable=True) == False, \"left side > right side\"\n\nassert compareSchemas(None,            _studentSchema3, testColumnOrder=True, testNullable=False) == False, \"Null schemaA\"\nassert compareSchemas(None,            None,            testColumnOrder=True, testNullable=False) == True,  \"Null schemaA and schemaB\"\nassert compareSchemas(_studentSchema2, None,            testColumnOrder=True, testNullable=False) == False, \"Null schemaB\"", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "ca759860-dc4e-4dbc-94de-1262a9227532", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "97c71f11-d7ed-430c-81db-888fbbf37c1f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 22, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%md\n## Testing compareRows\n\n```compareRows(rowA, rowB)```", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "16bd2116-55d7-433c-9f3e-eb2c142f8875", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "dc2567b8-9553-45a8-b68d-ceb27b0bb7bc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 23, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "from pyspark.sql import Row\n_rowA = Row(LastName=\"Duck\", MaxSalary=10000)\n_rowB = Row(LastName=\"Mouse\", MaxSalary=60000)\n_rowC = Row(MaxSalary=10000, LastName=\"Duck\")\n_rowD = Row(LastName=\"Duck\", MaxSalary=10000, City=\"Anaheim\")\n\nassert compareRows(_rowA, _rowB) == False       # different schemas\nassert compareRows(_rowA, _rowA) == True        # compare to self\nassert compareRows(_rowA, _rowC) == True        # order reversed\nassert compareRows(None, _rowA) == False        # Null rowA\nassert compareRows(None, None) == True          # Null rowA and rowB\nassert compareRows(_rowA, None) == False        # Null rowB\nassert compareRows(_rowA, _rowD) == False       # _rowA smaller than _rowD\nassert compareRows(_rowD, _rowA) == False       # _rowD bigger than _rowA\n\n# note Python doesn't allow you to define rows without a schema\n# _rowE = Row(\"Duck\", 10000)\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0f41a7ce-4b89-4868-a529-d908148c18b5", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "965cb615-b334-4bc9-9451-2e2db3bf3963", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 24, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "c3327924-5cbe-489f-a01d-f2dabc891342", "iPythonMetadata": null, "inputWidgets": {}, "language": "python", "name": "Assertion-Utils-Test", "origId": 0, "version": "NotebookV1"}