{"commands": [{"bindings": {}, "collapsed": false, "command": "\ncourseType = \"sp\"\ncourseAdvertisements = dict()\n\ndisplayHTML(\"Preparing the Python environment...\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "6e82e71f-3e22-4643-b64f-f9c6a57e612c", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7d2456df-83b7-44f8-b592-caed65d9ca87", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "24b4efa9-d7cf-42a3-a00b-1ffa4d6b84ed", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9038a2ad-d7d2-4d28-ba98-18a969faa320", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "f4131f4a-810f-4983-a3f6-276e3bdceda0", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9ec858ab-8fc3-4564-a86e-54e3921bd27a", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "moduleName = getModuleName()\nlessonName = getLessonName()\nusername = getUsername()\nuserhome = getUserhome()\nworkingDir = getWorkingDir(courseType)\ndatabaseName = createUserDatabase(courseType, username, moduleName, lessonName)\n\n# ****************************************************************************\n# Advertise variables we declared for the user - there are more, but these are the common ones\n# ****************************************************************************\ncourseAdvertisements[\"moduleName\"] =   (\"v\", moduleName,   \"No additional information was provided.\")\ncourseAdvertisements[\"lessonName\"] =   (\"v\", lessonName,   \"No additional information was provided.\")\ncourseAdvertisements[\"username\"] =     (\"v\", username,     \"No additional information was provided.\")\ncourseAdvertisements[\"userhome\"] =     (\"v\", userhome,     \"No additional information was provided.\")\ncourseAdvertisements[\"workingDir\"] =   (\"v\", workingDir,   \"No additional information was provided.\")\ncourseAdvertisements[\"databaseName\"] = (\"d\", databaseName, \"This is a private, per-notebook, database used to provide isolation from other users and exercises.\")\n\n# ****************************************************************************\n# Advertise functions we declared for the user - there are more, but these are the common ones\n# ****************************************************************************\ncourseAdvertisements[\"untilStreamIsReady\"] = (\"f\", \"name, progressions=3\", \"\"\"\n  <div>Introduced in the course <b>Structured Streaming</b>, this method blocks until the stream is actually ready for processing.</div>\n  <div>By default, it waits for 3 progressions of the stream to ensure sufficent data has been processed.</div>\"\"\")\ncourseAdvertisements[\"stopAllStreams\"] = (\"f\", \"\", \"\"\"\n  <div>Introduced in the course <b>Structured Streaming</b>, this method stops all active streams while providing extra exception handling.</div>\n  <div>It is functionally equivilent to:<div>\n  <div><code>for (s <- spark.streams.active) s.stop()</code></div>\"\"\")\n\ndisplayHTML(\"Defining custom variables for this lesson...\")\n\n# ****************************************************************************\n# Advertise are done here 100% of the time so that the are consistently \n# formatted. If left to each lesson, the meta data associated to each has to \n# be maintained in dozens of different places. This means that if a course\n# developer doesn't use a variable/function, then can simply suppress it later\n# by setting com.databricks.training.suppress.{key} to \"true\"\n# ****************************************************************************", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "3392ab88-0443-43e8-a01f-4ba382da81d9", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "350b00e3-6761-46b7-aa41-0a49b43e9477", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "0b1fe852-9006-405c-86fb-7818ededc8a0", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "b5f9eab1-599c-4077-abde-f488db2b1406", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "dae3ffd3-4168-47a6-8bd0-d44a852d5f2e", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "e5cd3d0d-ca60-4eeb-98e4-4907d40c8bb4", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dataset-Mounts", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5be9b1ec-99ab-4899-8462-65e9acc6d3cd", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "ce1d59e7-a6e7-4e0a-b5eb-8bae283124bc", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "# This script sets up MLflow and handles the case that \n# it is executed by Databricks' automated testing server\n\ndef mlflowAttached():\n  try:\n    import mlflow\n    return True\n  except ImportError:\n    return False\n\nif mlflowAttached():\n  import os\n  import mlflow\n  from mlflow.tracking import MlflowClient\n  from databricks_cli.configure.provider import get_config\n  from mlflow.exceptions import RestException\n  \n  notebookId = getTag(\"notebookId\")\n  os.environ['DATABRICKS_HOST'] = get_config().host\n  os.environ['DATABRICKS_TOKEN'] = get_config().token\n  \n  if notebookId:\n    os.environ[\"MLFLOW_AUTODETECT_EXPERIMENT_ID\"] = 'true'\n                    \n  else:\n    # Handles notebooks run by test server (executed as run)\n    # Convention is to use the notebook's name in the users' home directory which our testing framework abides by\n    experiment_name = dbutils.notebook.entry_point.getDbutils().notebook().getContext().notebookPath().getOrElse(None)\n    client = MlflowClient()\n    \n    try: experiment = client.get_experiment_by_name(experiment_name)\n    except Exception as e: pass # experiment doesn't exists\n\n    if experiment:\n      # Delete past runs if possible\n      try: client.delete_experiment(experiment.experiment_id) \n      except Exception as e: pass # ignored\n\n    try: mlflow.create_experiment(experiment_name)\n    except Exception as e: pass # ignored\n    \n    os.environ['MLFLOW_EXPERIMENT_NAME'] = experiment_name\n  \n  # Silence YAML deprecation issue https://github.com/yaml/pyyaml/wiki/PyYAML-yaml.load(input)-Deprecation\n  os.environ[\"PYTHONWARNINGS\"] = 'ignore::yaml.YAMLLoadWarning' \n  \nNone # suppress output", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "abf0fe04-daa9-4af9-a170-6ad10a5b0aa4", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "0617cea0-4215-46cc-bbdf-0c308d0a2e80", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "classroomCleanup(daLogger, courseType, username, moduleName, lessonName, False)\nNone # Suppress output", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "99fc0865-135a-47bc-be8e-d377609ceb48", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "560f6bb9-93a5-48cc-a499-130bb1a231e2", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 9, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "assertDbrVersion(spark.conf.get(\"com.databricks.training.expected-dbr\", None))\nNone # Suppress output\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d79f39ee-e28d-42e1-bd6a-326f5b46b214", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "6d2ccbc6-15b5-4f78-b243-4ecda1123ef6", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 10, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "13184087-2011-476a-a933-1b52a6bfaed6", "iPythonMetadata": null, "inputWidgets": {}, "language": "python", "name": "Common", "origId": 0, "version": "NotebookV1"}