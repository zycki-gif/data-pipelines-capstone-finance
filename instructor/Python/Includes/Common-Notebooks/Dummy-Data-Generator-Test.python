{"commands": [{"bindings": {}, "collapsed": false, "command": "\n%md\n# Dummy-Data-Generator-Test\nThe purpose of this notebook is to faciliate testing of the dummy data generator.", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "d8069cbc-08d1-4209-bf3e-7acb990ebf7b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "f3ea6ed2-b22a-485e-b1c2-579927203cda", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 1, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.conf.set(\"com.databricks.training.module-name\", \"common-notebooks\")", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "4e5e4bf1-9a39-48a5-9a19-17e296a58525", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "8457deb6-76cb-4c28-994a-e644ab32402f", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 2, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Class-Utility-Methods", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "88ca7203-5f25-4f82-976b-1c3dbf5b5b96", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "fe459764-cd6a-4809-a5a3-9b547a9915fa", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 3, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Assertion-Utils", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "14dc3044-9f3f-49a3-9f43-a9a694d05b2b", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "2a2789dc-03f4-460a-8df8-95253e238386", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 4, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "courseType = \"test\"\nmoduleName = getModuleName()\nlessonName = getLessonName()\nusername = getUsername()\nuserhome = getUserhome()\nworkingDir = getWorkingDir(courseType)\ndatabaseName = createUserDatabase(courseType, username, moduleName, lessonName)", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "79666920-435e-4d4e-bed6-1146fa1f0284", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "7b3480dd-ea5b-4400-9e1b-3bec6c3436b1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 5, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "%run ./Dummy-Data-Generator", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "bbbd2654-0e47-4f80-af60-0ca94b14d5ce", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "a60d8998-f146-484f-8746-6cc8fc57f24c", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 6, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "# name: String = \"Name\", \n# id: String = \"ID\", \n# password: String = \"Password\", \n# amount: String = \"Amount\", \n# percent: String = \"Percent\", \n# probability: String = \"Probability\", \n# yesNo: String = \"YesNo\", \n# UTCTime: String = \"UTCTime\"\nfrom pyspark.sql import Row\nfrom pyspark.sql.types import *\nimport os\n\n# default rows\ntestDefaultRowsDF = DummyData(\"test_1_python\").toDF()\nassert testDefaultRowsDF.count() == 300\n\n# custom rows\ntestCustomRowsDF = DummyData(\"test_2_python\", numRows=50).toDF()\nassert testCustomRowsDF.count() == 50\n\n# custom field names\ntestCustomField1DF = DummyData(\"test_3_python\").addNames(\"EmployeeName\").toDF()\nfields1 = testCustomField1DF.schema.names \nassert \"EmployeeName\" in fields1\nassert testCustomField1DF.schema.fields[1].dataType == StringType()\n\ntestCustomField2DF = DummyData(\"test_4_python\").renameId(\"EmployeeID\").toDF()\nfields2 = testCustomField2DF.schema.names \nassert \"EmployeeID\" in fields2\nassert testCustomField2DF.schema.fields[0].dataType == LongType()\n\ntestCustomField3DF = DummyData(\"test_5_python\").addPasswords(\"Yak\").toDF()\nfields3 = testCustomField3DF.schema.names\nassert testCustomField3DF.schema.fields[1].dataType == StringType()\nassert \"Yak\" in fields3\n\ntestCustomField4DF = DummyData(\"test_6_python\").addDoubles(\"Salary\").toDF()\nfields4 = testCustomField4DF.schema.names \nassert testCustomField4DF.schema.fields[1].dataType == DoubleType()\nassert \"Salary\" in fields4\n\ntestCustomField5DF = DummyData(\"test_7_python\").addIntegers(\"ZeroTo100\").toDF()\nfields5 = testCustomField5DF.schema.names \nassert testCustomField5DF.schema.fields[1].dataType == IntegerType()\nassert \"ZeroTo100\" in fields5\n\ntestCustomField6DF = DummyData(\"test_8_python\").addProportions(\"Prob\").toDF()\nfields6 = testCustomField6DF.schema.names \nassert testCustomField6DF.schema.fields[1].dataType == DoubleType()\nassert \"Prob\" in fields6 \n\ntestCustomField7DF = DummyData(\"test_9_python\").addBooleans(\"isOK\").toDF()\nfields7 = testCustomField7DF.schema.names \nassert testCustomField7DF.schema.fields[1].dataType == BooleanType()\nassert \"isOK\" in fields7\n\ntestCustomField8DF = DummyData(\"test_10_python\").addTimestamps(\"Timestamp\").toDF()\nfields8 = testCustomField8DF.schema.names \nassert testCustomField8DF.schema.fields[1].dataType == IntegerType()\nassert \"Timestamp\" in fields8\n\n# all custome field names, custom rows\ntestCustomFieldsDF = (DummyData(\"test_11_python\", numRows=50)\n    .addNames(\"EmployeeName\")\n    .renameId(\"EmployeeID\")\n    .addPasswords(\"Yak\")\n    .addDoubles(\"Salary\")\n    .addIntegers(\"ZeroTo100\")\n    .addProportions(\"Prob\")\n    .addBooleans(\"isOK\")\n    .addTimestamps(\"Timestamp\")\n    .toDF())\nfields = testCustomFieldsDF.schema.names\nassert fields == ['EmployeeID', 'EmployeeName', 'Yak', 'Salary', 'ZeroTo100', 'Prob', 'isOK', 'Timestamp']\nassert testCustomFieldsDF.count() == 50\nassert testCustomFieldsDF.schema.fields[0].dataType == LongType()\nassert testCustomFieldsDF.schema.fields[1].dataType == StringType()\nassert testCustomFieldsDF.schema.fields[2].dataType == StringType()\nassert testCustomFieldsDF.schema.fields[3].dataType == DoubleType()\nassert testCustomFieldsDF.schema.fields[4].dataType == IntegerType()\nassert testCustomFieldsDF.schema.fields[5].dataType == DoubleType()\nassert testCustomFieldsDF.schema.fields[6].dataType == BooleanType()\nassert testCustomFieldsDF.schema.fields[7].dataType == IntegerType()\n\n# needs to be done: restructure testing format to match class-utility-methods\n# needs to be done: add unit testing for the DummyData.add*() methods and their parameters\n# needs to be done: add value testing", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "5d116de6-f14d-4705-83e1-e54c1c78aa61", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "562adc57-41d1-4507-9093-6598aee560f1", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 7, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}, {"bindings": {}, "collapsed": false, "command": "spark.sql(f\"DROP DATABASE IF EXISTS {databaseName} CASCADE\")\n", "commandTitle": "", "commandType": "auto", "commandVersion": 0, "commentThread": [], "commentsVisible": false, "customPlotOptions": {}, "datasetPreviewNameToCmdIdMap": {}, "diffDeletes": [], "diffInserts": [], "displayType": "table", "error": null, "errorSummary": null, "finishTime": 0, "globalVars": {}, "guid": "9bd41e35-486a-4dad-8ff0-06466d825589", "height": "auto", "hideCommandCode": false, "hideCommandResult": false, "iPythonMetadata": null, "inputWidgets": {}, "latestUser": "", "latestUserId": null, "nuid": "9dbc63d9-dfd8-465e-b15b-9c111b395eda", "origId": 0, "parentHierarchy": [], "pivotAggregation": null, "pivotColumns": null, "position": 8, "results": null, "showCommandTitle": false, "startTime": 0, "state": "finished", "streamStates": {}, "submitTime": 0, "subtype": "command", "version": "CommandV1", "width": "auto", "workflows": [], "xColumns": null, "yColumns": null}], "dashboards": [], "globalVars": {}, "guid": "0545fcc0-6723-42ce-a185-bb8e518ab25d", "iPythonMetadata": null, "inputWidgets": {}, "language": "python", "name": "Dummy-Data-Generator-Test", "origId": 0, "version": "NotebookV1"}